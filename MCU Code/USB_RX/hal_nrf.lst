C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 1   


C51 COMPILER V9.03, COMPILATION OF MODULE HAL_NRF
OBJECT MODULE PLACED IN .\hal_nrf.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE ..\hal\nrf24l01p\hal_nrf.c LARGE BROWSE INCDIR(.;..\compiler\c51;..\hal\nrf
                    -24lu1p;..\hal\nrf24l01p;..\hal;..\compiler\common) DEFINE(MCU_NRF24LU1P) DEBUG OBJECTEXTEND CODE LISTINCLUDE SYMBOLS PRI
                    -NT(.\hal_nrf.lst) PREPRINT(.\hal_nrf.i) OBJECT(.\hal_nrf.obj)

line level    source

   1          /* Copyright (c) 2009 Nordic Semiconductor. All Rights Reserved.
   2           *
   3           * The information contained herein is confidential property of Nordic
   4           * Semiconductor ASA.Terms and conditions of usage are described in detail
   5           * in NORDIC SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT.
   6           *
   7           * Licensees are granted free, non-transferable use of the information. NO
   8           * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9           * the file.
  10           *
  11           * $LastChangedRevision: 133 $
  12           */
  13          
  14           /** @file
  15            * @brief Implementation of hal_nrf
  16           */
  17          /*lint -t2 */
  18          /*lint -esym( 534, hal_nrf_write_reg ) */
  19          /*lint -esym( 534, hal_nrf_rw ) */
  20          /*lint -e708 */
  21          /*lint -e46 */
  22          
  23          #include <stdint.h>
   1      =1  /* Copyright (c) 2007 Nordic Semiconductor. All Rights Reserved.
   2      =1   *
   3      =1   * The information contained herein is property of Nordic Semiconductor ASA.
   4      =1   * Terms and conditions of usage are described in detail in NORDIC
   5      =1   * SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6      =1   *
   7      =1   * Licensees are granted free, non-transferable use of the information. NO
   8      =1   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =1   * the file.
  10      =1   *
  11      =1   * $LastChangedRevision: 186 $
  12      =1   */
  13      =1  
  14      =1  /** @file
  15      =1   * Type definitions for firmware projects developed at Nordic Semiconductor.
  16      =1   *
  17      =1   * Standard storage classes in C, such as @c char, @c int, and @c long, are not always
  18      =1   * interpreted in the same way by the compiler. The types here are defined by their
  19      =1   * bit length and signed/unsigned property, as their names indicate. The correlation
  20      =1   * between the name and properties of the storage class should be true, regardless of
  21      =1   * the compiler being used.
  22      =1   */
  23      =1  
  24      =1  #ifndef __STDINT_H__
  25      =1  #define __STDINT_H__
  26      =1  
  27      =1  #ifdef __C51__
  28      =1  
  29      =1  typedef unsigned char uint8_t;        ///< 8 bit unsigned int
  30      =1  
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 2   

  31      =1  typedef signed char int8_t;          ///< 8 bit signed int
  32      =1  
  33      =1  typedef unsigned int uint16_t;        ///< 16 bit unsigned int
  34      =1  
  35      =1  typedef signed int int16_t;          ///< 16 bit signed int
  36      =1  
  37      =1  typedef unsigned long uint32_t;       ///< 32 bit unsigned int
  38      =1  
  39      =1  typedef signed long int32_t;         ///< 32 bit signed int
  40      =1  
  41      =1  #endif // __C51__
  42      =1  
  43      =1  #ifndef NULL
  44      =1  #define NULL (void*)0
  45      =1  #endif
  46      =1  
  47      =1  #endif // __STDINT_H__
  24          #include <stdbool.h>
   1      =1  /* Copyright (c) 2007 Nordic Semiconductor. All Rights Reserved.
   2      =1   *
   3      =1   * The information contained herein is property of Nordic Semiconductor ASA.
   4      =1   * Terms and conditions of usage are described in detail in NORDIC
   5      =1   * SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT.
   6      =1   *
   7      =1   * Licensees are granted free, non-transferable use of the information. NO
   8      =1   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =1   * the file.
  10      =1   *
  11      =1   * $LastChangedRevision: 230 $
  12      =1   */
  13      =1  
  14      =1  /** @file
  15      =1   * Type definitions for firmware projects developed at Nordic Semiconductor.
  16      =1   *
  17      =1   * Standard storage classes in C, such as @c char, @c int, and @c long, are not always
  18      =1   * interpreted in the same way by the compiler. The types here are defined by their
  19      =1   * bit length and signed/unsigned property, as their names indicate. The correlation
  20      =1   * between the name and properties of the storage class should be true, regardless of
  21      =1   * the compiler being used.
  22      =1   */
  23      =1  
  24      =1  #ifndef __STDBOOL_H__
  25      =1  #define __STDBOOL_H__
  26      =1  
  27      =1  //lint -strong(b,_Bool)
  28      =1  typedef unsigned char _Bool; ///< Boolean type
  29      =1  
  30      =1  #define bool _Bool
  31      =1  #define true ((bool)1)
  32      =1  #define false ((bool)0)
  33      =1  #define __bool_true_false_are_defined 1
  34      =1  
  35      =1  #endif // __STDBOOL_H__
  25          
  26          #include "nordic_common.h"
   1      =1  /* Copyright (c) 2009 Nordic Semiconductor. All Rights Reserved.
   2      =1   *
   3      =1   * The information contained herein is confidential property of Nordic 
   4      =1   * Semiconductor ASA.Terms and conditions of usage are described in detail 
   5      =1   * in NORDIC SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6      =1   *
   7      =1   * Licensees are granted free, non-transferable use of the information. NO
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 3   

   8      =1   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =1   * the file.
  10      =1   *              
  11      =1   * $LastChangedRevision: 133 $
  12      =1   */
  13      =1  
  14      =1  /** @file
  15      =1   * @brief Common defines and macros for firmware developed by Nordic Semiconductor.
  16      =1   *
  17      =1   */
  18      =1  
  19      =1  #ifndef NORDIC_COMMON_H__
  20      =1  #define NORDIC_COMMON_H__
  21      =1  
  22      =1  /** Swaps the upper byte with the lower byte in a 16 bit variable */
  23      =1  //lint -emacro((572),SWAP) // Suppress warning 572 "Excessive shift value"
  24      =1  #define SWAP(x) ((((x)&0xFF)<<8)|(((x)>>8)&0xFF))
  25      =1  
  26      =1  /** The upper 8 bits of a 16 bit value */
  27      =1  #define MSB(a) ((a & 0xFF00) >> 8)
  28      =1  /** The lower 8 bits (of a 16 bit value) */
  29      =1  #define LSB(a) ((a & 0xFF))
  30      =1  
  31      =1  /** Leaves the minimum of the two arguments */
  32      =1  #define MIN(a, b) ((a) < (b) ? (a) : (b))
  33      =1  /** Leaves the maximum of the two arguments */
  34      =1  #define MAX(a, b) ((a) < (b) ? (b) : (a))
  35      =1  
  36      =1  #define BIT_0 0x01 /**< The value of bit 0 */
  37      =1  #define BIT_1 0x02 /**< The value of bit 1 */
  38      =1  #define BIT_2 0x04 /**< The value of bit 2 */
  39      =1  #define BIT_3 0x08 /**< The value of bit 3 */
  40      =1  #define BIT_4 0x10 /**< The value of bit 4 */
  41      =1  #define BIT_5 0x20 /**< The value of bit 5 */
  42      =1  #define BIT_6 0x40 /**< The value of bit 6 */
  43      =1  #define BIT_7 0x80 /**< The value of bit 7 */
  44      =1  #define BIT_8 0x0100 /**< The value of bit 8 */
  45      =1  #define BIT_9 0x0200 /**< The value of bit 9 */
  46      =1  #define BIT_10 0x0400 /**< The value of bit 10 */
  47      =1  #define BIT_11 0x0800 /**< The value of bit 11 */
  48      =1  #define BIT_12 0x1000 /**< The value of bit 12 */
  49      =1  #define BIT_13 0x2000 /**< The value of bit 13 */
  50      =1  #define BIT_14 0x4000 /**< The value of bit 14 */
  51      =1  #define BIT_15 0x8000 /**< The value of bit 15 */
  52      =1  
  53      =1  
  54      =1  #endif // NORDIC_COMMON_H__
  27          #include "hal_nrf.h"
   1      =1  /* Copyright (c) 2009 Nordic Semiconductor. All Rights Reserved.
   2      =1   *
   3      =1   * The information contained herein is confidential property of Nordic 
   4      =1   * Semiconductor ASA.Terms and conditions of usage are described in detail 
   5      =1   * in NORDIC SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6      =1   *
   7      =1   * Licensees are granted free, non-transferable use of the information. NO
   8      =1   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =1   * the file.
  10      =1   *              
  11      =1   * $LastChangedRevision: 133 $
  12      =1   */
  13      =1  
  14      =1  /** @file
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 4   

  15      =1   * @brief Interface functions for the on-chip radio transceiver. 
  16      =1   */
  17      =1   
  18      =1  /** @defgroup hal_nrf24l01p_hal_nrf RF tranceiver (hal_nrf)
  19      =1   * @{
  20      =1   * @ingroup hal_nrf24l01p
  21      =1   * 
  22      =1   * This is the nRF24L01+ transceiver used in several Nordic Semiconductor devices.
  23      =1   * The transceiver is set up and controlled via an internal SPI interface on the chip. 
  24      =1   * The HAL for the radio transceiver hides this SPI interface from the programmer.
  25      =1   *
  26      =1   * The nRF24LE1 uses the same 2.4GHz GFSK RF transceiver with embedded protocol engine 
  27      =1   * (Enhanced ShockBurst&tm;) that is found in the nRF24L01+ single chip RF Transceiver.
  28      =1   *
  29      =1   * The RF Transceiver module is configured and operated through the RF transceiver map. 
  30      =1   * This register map is accessed by the MCU through a dedicated on-chip Serial 
  31      =1   * Peripheral interface (SPI) and is available in all power modes of the RF Transceiver 
  32      =1   * module. The register map contains all configuration registers in the RF Transceiver 
  33      =1   * and is accessible in all operation modes of the transceiver. The radio transceiver 
  34      =1   * HAL hides this register map and the usage of the internal SPI.
  35      =1   * 
  36      =1   * This HAL module contains setup functions for configurating the radio; operation functions 
  37      =1   * for controlling the radio when active and for sending and receiving data; and test 
  38      =1   * functions for setting the radio in test modes.
  39      =1   */
  40      =1  
  41      =1  #ifndef HAL_NRF_H__
  42      =1  #define HAL_NRF_H__
  43      =1  
  44      =1  #include <stdint.h>
   1      =2  /* Copyright (c) 2007 Nordic Semiconductor. All Rights Reserved.
   2      =2   *
   3      =2   * The information contained herein is property of Nordic Semiconductor ASA.
   4      =2   * Terms and conditions of usage are described in detail in NORDIC
   5      =2   * SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6      =2   *
   7      =2   * Licensees are granted free, non-transferable use of the information. NO
   8      =2   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =2   * the file.
  10      =2   *
  11      =2   * $LastChangedRevision: 186 $
  12      =2   */
  13      =2  
  14      =2  /** @file
  15      =2   * Type definitions for firmware projects developed at Nordic Semiconductor.
  16      =2   *
  17      =2   * Standard storage classes in C, such as @c char, @c int, and @c long, are not always
  18      =2   * interpreted in the same way by the compiler. The types here are defined by their
  19      =2   * bit length and signed/unsigned property, as their names indicate. The correlation
  20      =2   * between the name and properties of the storage class should be true, regardless of
  21      =2   * the compiler being used.
  22      =2   */
  23      =2  
  24      =2  #ifndef __STDINT_H__
           =2 #define __STDINT_H__
           =2 
           =2 #ifdef __C51__
           =2 
           =2 typedef unsigned char uint8_t;        ///< 8 bit unsigned int
           =2 
           =2 typedef signed char int8_t;          ///< 8 bit signed int
           =2 
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 5   

           =2 typedef unsigned int uint16_t;        ///< 16 bit unsigned int
           =2 
           =2 typedef signed int int16_t;          ///< 16 bit signed int
           =2 
           =2 typedef unsigned long uint32_t;       ///< 32 bit unsigned int
           =2 
           =2 typedef signed long int32_t;         ///< 32 bit signed int
           =2 
           =2 #endif // __C51__
           =2 
           =2 #ifndef NULL
           =2 #define NULL (void*)0
           =2 #endif
           =2 
           =2 #endif // __STDINT_H__
  45      =1  #include <stdbool.h>
   1      =2  /* Copyright (c) 2007 Nordic Semiconductor. All Rights Reserved.
   2      =2   *
   3      =2   * The information contained herein is property of Nordic Semiconductor ASA.
   4      =2   * Terms and conditions of usage are described in detail in NORDIC
   5      =2   * SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT.
   6      =2   *
   7      =2   * Licensees are granted free, non-transferable use of the information. NO
   8      =2   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =2   * the file.
  10      =2   *
  11      =2   * $LastChangedRevision: 230 $
  12      =2   */
  13      =2  
  14      =2  /** @file
  15      =2   * Type definitions for firmware projects developed at Nordic Semiconductor.
  16      =2   *
  17      =2   * Standard storage classes in C, such as @c char, @c int, and @c long, are not always
  18      =2   * interpreted in the same way by the compiler. The types here are defined by their
  19      =2   * bit length and signed/unsigned property, as their names indicate. The correlation
  20      =2   * between the name and properties of the storage class should be true, regardless of
  21      =2   * the compiler being used.
  22      =2   */
  23      =2  
  24      =2  #ifndef __STDBOOL_H__
           =2 #define __STDBOOL_H__
           =2 
           =2 //lint -strong(b,_Bool)
           =2 typedef unsigned char _Bool; ///< Boolean type
           =2 
           =2 #define bool _Bool
           =2 #define true ((bool)1)
           =2 #define false ((bool)0)
           =2 #define __bool_true_false_are_defined 1
           =2 
           =2 #endif // __STDBOOL_H__
  46      =1  
  47      =1  #include "hal_nrf_reg.h"
   1      =2  /* Copyright (c) 2009 Nordic Semiconductor. All Rights Reserved.
   2      =2   *
   3      =2   * The information contained herein is confidential property of Nordic 
   4      =2   * Semiconductor ASA.Terms and conditions of usage are described in detail 
   5      =2   * in NORDIC SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6      =2   *
   7      =2   * Licensees are granted free, non-transferable use of the information. NO
   8      =2   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =2   * the file.
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 6   

  10      =2   *              
  11      =2   * $LastChangedRevision: 173 $
  12      =2   */
  13      =2  
  14      =2  /** @file
  15      =2  @brief Register definitions for nRF24L01+
  16      =2  
  17      =2  @details Header file defining register mapping with bit definitions. 
  18      =2  This file is radio-chip dependent, and are included with the hal_nrf.h
  19      =2  
  20      =2  @ingroup hal_nrf24l01p_hal_nrf
  21      =2   */
  22      =2  
  23      =2  #ifndef HAL_NRF_REG_H__
  24      =2  #define HAL_NRF_REG_H__
  25      =2  
  26      =2  /** @name - Instruction Set - */
  27      =2  //@{
  28      =2  /* nRF24L01 Instruction Definitions */
  29      =2  #define W_REGISTER         0x20  /**< Register write command */
  30      =2  #define R_RX_PAYLOAD       0x61  /**< Read RX payload command */
  31      =2  #define W_TX_PAYLOAD       0xA0  /**< Write TX payload command */
  32      =2  #define FLUSH_TX           0xE1  /**< Flush TX register command */
  33      =2  #define FLUSH_RX           0xE2  /**< Flush RX register command */
  34      =2  #define REUSE_TX_PL        0xE3  /**< Reuse TX payload command */
  35      =2  #define ACTIVATE           0x50  /**< Activate features */
  36      =2  #define R_RX_PL_WID        0x60  /**< Read RX payload command */
  37      =2  #define W_ACK_PAYLOAD      0xA8  /**< Write ACK payload command */
  38      =2  #define W_TX_PAYLOAD_NOACK 0xB0  /**< Write ACK payload command */
  39      =2  #define NOP                0xFF  /**< No Operation command, used for reading status register */
  40      =2  //@}
  41      =2  
  42      =2  /** @name  - Register Memory Map - */
  43      =2  //@{
  44      =2  /* nRF24L01 * Register Definitions * */
  45      =2  #define CONFIG        0x00  /**< nRF24L01 config register */
  46      =2  #define EN_AA         0x01  /**< nRF24L01 enable Auto-Acknowledge register */
  47      =2  #define EN_RXADDR     0x02  /**< nRF24L01 enable RX addresses register */
  48      =2  #define SETUP_AW      0x03  /**< nRF24L01 setup of address width register */
  49      =2  #define SETUP_RETR    0x04  /**< nRF24L01 setup of automatic retransmission register */
  50      =2  #define RF_CH         0x05  /**< nRF24L01 RF channel register */
  51      =2  #define RF_SETUP      0x06  /**< nRF24L01 RF setup register */
  52      =2  #define STATUS        0x07  /**< nRF24L01 status register */
  53      =2  #define OBSERVE_TX    0x08  /**< nRF24L01 transmit observe register */
  54      =2  #define CD            0x09  /**< nRF24L01 carrier detect register */
  55      =2  #define RX_ADDR_P0    0x0A  /**< nRF24L01 receive address data pipe0 */
  56      =2  #define RX_ADDR_P1    0x0B  /**< nRF24L01 receive address data pipe1 */
  57      =2  #define RX_ADDR_P2    0x0C  /**< nRF24L01 receive address data pipe2 */
  58      =2  #define RX_ADDR_P3    0x0D  /**< nRF24L01 receive address data pipe3 */
  59      =2  #define RX_ADDR_P4    0x0E  /**< nRF24L01 receive address data pipe4 */
  60      =2  #define RX_ADDR_P5    0x0F  /**< nRF24L01 receive address data pipe5 */
  61      =2  #define TX_ADDR       0x10  /**< nRF24L01 transmit address */
  62      =2  #define RX_PW_P0      0x11  /**< nRF24L01 \# of bytes in rx payload for pipe0 */
  63      =2  #define RX_PW_P1      0x12  /**< nRF24L01 \# of bytes in rx payload for pipe1 */
  64      =2  #define RX_PW_P2      0x13  /**< nRF24L01 \# of bytes in rx payload for pipe2 */
  65      =2  #define RX_PW_P3      0x14  /**< nRF24L01 \# of bytes in rx payload for pipe3 */
  66      =2  #define RX_PW_P4      0x15  /**< nRF24L01 \# of bytes in rx payload for pipe4 */
  67      =2  #define RX_PW_P5      0x16  /**< nRF24L01 \# of bytes in rx payload for pipe5 */
  68      =2  #define FIFO_STATUS   0x17  /**< nRF24L01 FIFO status register */
  69      =2  #define DYNPD         0x1C  /**< nRF24L01 Dynamic payload setup */
  70      =2  #define FEATURE       0x1D  /**< nRF24L01 Exclusive feature setup */
  71      =2  
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 7   

  72      =2  //@}
  73      =2  
  74      =2  /* nRF24L01 related definitions */
  75      =2  /* Interrupt definitions */
  76      =2  /* Operation mode definitions */
  77      =2  
  78      =2  /** An enum describing the radio's irq sources.
  79      =2   *
  80      =2   */
  81      =2  typedef enum {
  82      =2      HAL_NRF_MAX_RT = 4,     /**< Max retries interrupt */
  83      =2      HAL_NRF_TX_DS,          /**< TX data sent interrupt */
  84      =2      HAL_NRF_RX_DR           /**< RX data received interrupt */
  85      =2  } hal_nrf_irq_source_t;
  86      =2  
  87      =2  /* Operation mode definitions */
  88      =2  /** An enum describing the radio's power mode.
  89      =2   *
  90      =2   */
  91      =2  typedef enum {
  92      =2      HAL_NRF_PTX,            /**< Primary TX operation */
  93      =2      HAL_NRF_PRX             /**< Primary RX operation */
  94      =2  } hal_nrf_operation_mode_t;
  95      =2  
  96      =2  /** An enum describing the radio's power mode.
  97      =2   *
  98      =2   */
  99      =2  typedef enum {
 100      =2      HAL_NRF_PWR_DOWN,       /**< Device power-down */
 101      =2      HAL_NRF_PWR_UP          /**< Device power-up */
 102      =2  } hal_nrf_pwr_mode_t;
 103      =2  
 104      =2  /** An enum describing the radio's output power mode's.
 105      =2   *
 106      =2   */
 107      =2  typedef enum {
 108      =2      HAL_NRF_18DBM,          /**< Output power set to -18dBm */
 109      =2      HAL_NRF_12DBM,          /**< Output power set to -12dBm */
 110      =2      HAL_NRF_6DBM,           /**< Output power set to -6dBm  */
 111      =2      HAL_NRF_0DBM            /**< Output power set to 0dBm   */
 112      =2  } hal_nrf_output_power_t;
 113      =2  
 114      =2  /** An enum describing the radio's on-air datarate.
 115      =2   *
 116      =2   */
 117      =2  typedef enum {
 118      =2      HAL_NRF_1MBPS,          /**< Datarate set to 1 Mbps  */
 119      =2      HAL_NRF_2MBPS,          /**< Datarate set to 2 Mbps  */
 120      =2      HAL_NRF_250KBPS         /**< Datarate set to 250 kbps*/
 121      =2  } hal_nrf_datarate_t;
 122      =2  
 123      =2  /** An enum describing the radio's CRC mode.
 124      =2   *
 125      =2   */
 126      =2  typedef enum {
 127      =2      HAL_NRF_CRC_OFF,    /**< CRC check disabled */
 128      =2      HAL_NRF_CRC_8BIT,   /**< CRC check set to 8-bit */
 129      =2      HAL_NRF_CRC_16BIT   /**< CRC check set to 16-bit */
 130      =2  } hal_nrf_crc_mode_t;
 131      =2  
 132      =2  /** An enum describing the read/write payload command.
 133      =2   *
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 8   

 134      =2   */
 135      =2  typedef enum {
 136      =2      HAL_NRF_TX_PLOAD = 7,   /**< TX payload definition */
 137      =2      HAL_NRF_RX_PLOAD,        /**< RX payload definition */
 138      =2      HAL_NRF_ACK_PLOAD
 139      =2  } hal_nrf_pload_command_t;
 140      =2  
 141      =2  /** Structure containing the radio's address map.
 142      =2   * Pipe0 contains 5 unique address bytes,
 143      =2   * while pipe[1..5] share the 4 MSB bytes, set in pipe1.
 144      =2   * <p><b> - Remember that the LSB byte for all pipes have to be unique! -</b>
 145      =2   */
 146      =2  // nRF24L01 Address struct
 147      =2  
 148      =2  
 149      =2  //typedef struct {
 150      =2  //   uint8_t p0[5];            /**< Pipe0 address, 5 bytes */
 151      =2  //    uint8_t p1[5];            /**< Pipe1 address, 5 bytes, 4 MSB bytes shared for pipe1 to pipe5 */
 152      =2  //    uint8_t p2[1];            /**< Pipe2 address, 1 byte */
 153      =2  //    uint8_t p3[1];            /**< Pipe3 address, 1 byte */
 154      =2  //   uint8_t p4[1];            /**< Pipe3 address, 1 byte */
 155      =2  //   uint8_t p5[1];            /**< Pipe3 address, 1 byte */
 156      =2  //   uint8_t tx[5];            /**< TX address, 5 byte */
 157      =2  //} hal_nrf_l01_addr_map;
 158      =2  
 159      =2  
 160      =2  /** An enum describing the nRF24L01 pipe addresses and TX address.
 161      =2   *
 162      =2   */
 163      =2  typedef enum {
 164      =2      HAL_NRF_PIPE0 = 0,          /**< Select pipe0 */
 165      =2      HAL_NRF_PIPE1,              /**< Select pipe1 */
 166      =2      HAL_NRF_PIPE2,              /**< Select pipe2 */
 167      =2      HAL_NRF_PIPE3,              /**< Select pipe3 */
 168      =2      HAL_NRF_PIPE4,              /**< Select pipe4 */
 169      =2      HAL_NRF_PIPE5,              /**< Select pipe5 */
 170      =2      HAL_NRF_TX,                 /**< Refer to TX address*/
 171      =2      HAL_NRF_ALL = 0xFF          /**< Close or open all pipes*/
 172      =2                                  /**< @see hal_nrf_set_address @see hal_nrf_get_address
 173      =2                                   @see hal_nrf_open_pipe  @see hal_nrf_close_pipe */
 174      =2  } hal_nrf_address_t;
 175      =2  
 176      =2  /** An enum describing the radio's address width.
 177      =2   *
 178      =2   */
 179      =2  typedef enum {
 180      =2      HAL_NRF_AW_3BYTES = 3,      /**< Set address width to 3 bytes */
 181      =2      HAL_NRF_AW_4BYTES,          /**< Set address width to 4 bytes */
 182      =2      HAL_NRF_AW_5BYTES           /**< Set address width to 5 bytes */
 183      =2  } hal_nrf_address_width_t;
 184      =2  
 185      =2  
 186      =2  /** @name CONFIG register bit definitions */
 187      =2  //@{
 188      =2  
 189      =2  #define MASK_RX_DR    6     /**< CONFIG register bit 6 */
 190      =2  #define MASK_TX_DS    5     /**< CONFIG register bit 5 */
 191      =2  #define MASK_MAX_RT   4     /**< CONFIG register bit 4 */
 192      =2  #define EN_CRC        3     /**< CONFIG register bit 3 */
 193      =2  #define CRCO          2     /**< CONFIG register bit 2 */
 194      =2  #define PWR_UP        1     /**< CONFIG register bit 1 */
 195      =2  #define PRIM_RX       0     /**< CONFIG register bit 0 */
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 9   

 196      =2  //@}
 197      =2  
 198      =2  /** @name RF_SETUP register bit definitions */
 199      =2  //@{
 200      =2  #define PLL_LOCK      4     /**< RF_SETUP register bit 4 */
 201      =2  #define RF_DR         3     /**< RF_SETUP register bit 3 */
 202      =2  #define RF_PWR1       2     /**< RF_SETUP register bit 2 */
 203      =2  #define RF_PWR0       1     /**< RF_SETUP register bit 1 */
 204      =2  #define LNA_HCURR     0     /**< RF_SETUP register bit 0 */
 205      =2  //@}
 206      =2  
 207      =2  /* STATUS 0x07 */
 208      =2  /** @name STATUS register bit definitions */
 209      =2  //@{
 210      =2  #define RX_DR         6     /**< STATUS register bit 6 */
 211      =2  #define TX_DS         5     /**< STATUS register bit 5 */
 212      =2  #define MAX_RT        4     /**< STATUS register bit 4 */
 213      =2  #define TX_FULL       0     /**< STATUS register bit 0 */
 214      =2  //@}
 215      =2  
 216      =2  /* FIFO_STATUS 0x17 */
 217      =2  /** @name FIFO_STATUS register bit definitions */
 218      =2  //@{
 219      =2  #define TX_REUSE      6     /**< FIFO_STATUS register bit 6 */
 220      =2  #define TX_FIFO_FULL  5     /**< FIFO_STATUS register bit 5 */
 221      =2  #define TX_EMPTY      4     /**< FIFO_STATUS register bit 4 */
 222      =2  #define RX_FULL       1     /**< FIFO_STATUS register bit 1 */
 223      =2  #define RX_EMPTY      0     /**< FIFO_STATUS register bit 0 */
 224      =2  //@}
 225      =2  
 226      =2  #endif // HAL_NRF_REG_H__
 227      =2  /** @} */
  48      =1  #include "hal_nrf_hw.h"
   1      =2  /* Copyright (c) 2009 Nordic Semiconductor. All Rights Reserved.
   2      =2   *
   3      =2   * The information contained herein is confidential property of Nordic 
   4      =2   * Semiconductor ASA.Terms and conditions of usage are described in detail 
   5      =2   * in NORDIC SEMICONDUCTOR STANDARD SOFTWARE LICENSE AGREEMENT. 
   6      =2   *
   7      =2   * Licensees are granted free, non-transferable use of the information. NO
   8      =2   * WARRENTY of ANY KIND is provided. This heading must NOT be removed from
   9      =2   * the file.
  10      =2   *              
  11      =2   * $LastChangedRevision: 133 $
  12      =2   */
  13      =2  
  14      =2  /** @file
  15      =2  * @brief hal_nrf macros for nRF24LU1+
  16      =2   *
  17      =2   * @defgroup hal_nrf24lu1p_hal_nrf_hw hal_nrf_hw
  18      =2   * @{
  19      =2   * @ingroup hal_nrf24lu1p
  20      =2   *
  21      =2   */
  22      =2  
  23      =2  #ifndef HAL_NRF_LU1_H__
  24      =2  #define HAL_NRF_LU1_H__
  25      =2  #include "nrf24lu1p.h"
   1      =3  #ifndef NRF24LU1P_H
   2      =3  #define NRF24LU1P_H
   3      =3  
   4      =3  #ifdef __ICC8051__
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 10  

           =3 #include <ionRF24LU1p.h>
           =3 #include <bit24lu1.h>
           =3 #endif /*__ICC8051__*/
   8      =3  
   9      =3  #ifdef __C51__
  10      =3  #include <Nordic\reg24lu1.h>
   1      =4  /*--------------------------------------------------------------------------
   2      =4   * reg24lu1.h
   3      =4   *
   4      =4   * Keil C51 header file for the Nordic Semiconductor nRF24LU1 2.4GHz RF
   5      =4   * transceiver with embedded 8051 compatible microcontroller and USB.
   6      =4   *
   7      =4   *
   8      =4   *------------------------------------------------------------------------*/
   9      =4  #ifndef __REG24LU1_H__
  10      =4  #define __REG24LU1_H__
  11      =4  
  12      =4  //-----------------------------------------------------------------------------
  13      =4  // Byte Registers
  14      =4  //-----------------------------------------------------------------------------
  15      =4  
  16      =4  sfr   P0           = 0x80;
  17      =4  sfr   SP           = 0x81;
  18      =4  sfr   DPL          = 0x82;
  19      =4  sfr   DPH          = 0x83;
  20      =4  sfr   DPL1         = 0x84;
  21      =4  sfr   DPH1         = 0x85;
  22      =4  sfr   PCON         = 0x87;
  23      =4  sfr   TCON         = 0x88;
  24      =4  sfr   TMOD         = 0x89;
  25      =4  sfr   TL0          = 0x8A;
  26      =4  sfr   TL1          = 0x8B;
  27      =4  sfr   TH0          = 0x8C;
  28      =4  sfr   TH1          = 0x8D;
  29      =4  sfr   CKCON        = 0x8E;
  30      =4  sfr   RFCON        = 0x90;
  31      =4  sfr   DPS          = 0x92;
  32      =4  sfr   P0DIR        = 0x94;
  33      =4  sfr   P0ALT        = 0x95;
  34      =4  sfr   S0CON        = 0x98;
  35      =4  sfr   S0BUF        = 0x99;
  36      =4  sfr   IEN2         = 0x9A;
  37      =4  sfr   USBCON       = 0xA0;
  38      =4  sfr   CLKCTL       = 0xA3;
  39      =4  sfr   PWRDWN       = 0xA4;
  40      =4  sfr   WUCONF       = 0xA5;
  41      =4  sfr   INTEXP       = 0xA6;
  42      =4  sfr   IEN0         = 0xA8;
  43      =4  sfr   IP0          = 0xA9;
  44      =4  sfr   S0RELL       = 0xAA;
  45      =4  sfr   REGXH        = 0xAB;
  46      =4  sfr   REGXL        = 0xAC;
  47      =4  sfr   REGXC        = 0xAD;
  48      =4  sfr   RSTRES       = 0xB1;
  49      =4  sfr   SMDAT        = 0xB2;
  50      =4  sfr   SMCTL        = 0xB3;
  51      =4  sfr   TICKDV       = 0xB5;
  52      =4  sfr   IEN1         = 0xB8;
  53      =4  sfr   IP1          = 0xB9;
  54      =4  sfr   S0RELH       = 0xBA;
  55      =4  sfr   SSCONF       = 0xBC;
  56      =4  sfr   SSDATA       = 0xBD;
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 11  

  57      =4  sfr   SSSTAT       = 0xBE;
  58      =4  sfr   IRCON        = 0xC0;
  59      =4  sfr   CCEN         = 0xC1;
  60      =4  sfr   CCL1         = 0xC2;
  61      =4  sfr   CCH1         = 0xC3;
  62      =4  sfr   CCL2         = 0xC4;
  63      =4  sfr   CCH2         = 0xC5;
  64      =4  sfr   CCL3         = 0xC6;
  65      =4  sfr   CCH3         = 0xC7;
  66      =4  sfr   T2CON        = 0xC8;
  67      =4  sfr   P0EXP        = 0xC9;
  68      =4  sfr   CRCL         = 0xCA;
  69      =4  sfr   CRCH         = 0xCB;
  70      =4  sfr   TL2          = 0xCC;
  71      =4  sfr   TH2          = 0xCD;
  72      =4  sfr   PSW          = 0xD0;
  73      =4  sfr   WDCON        = 0xD8;
  74      =4  sfr   USBSLP       = 0xD9;
  75      =4  sfr   ACC          = 0xE0;
  76      =4  sfr   RFDAT        = 0xE5;
  77      =4  sfr   RFCTL        = 0xE6;
  78      =4  sfr   AESCS        = 0xE8;
  79      =4  sfr   MD0          = 0xE9;
  80      =4  sfr   MD1          = 0xEA;
  81      =4  sfr   MD2          = 0xEB;
  82      =4  sfr   MD3          = 0xEC;
  83      =4  sfr   MD4          = 0xED;
  84      =4  sfr   MD5          = 0xEE;
  85      =4  sfr   ARCON        = 0xEF;
  86      =4  sfr   B            = 0xF0;
  87      =4  sfr   AESKIN       = 0xF1;
  88      =4  sfr   AESIV        = 0xF2;
  89      =4  sfr   AESD         = 0xF3;
  90      =4  sfr   AESIA1       = 0xF5;
  91      =4  sfr   AESIA2       = 0xF6;
  92      =4  sfr   FSR          = 0xF8;
  93      =4  sfr   FPCR         = 0xF9;
  94      =4  sfr   FCR          = 0xFA;
  95      =4  
  96      =4  //-----------------------------------------------------------------------------
  97      =4  // Word Registers
  98      =4  //-----------------------------------------------------------------------------
  99      =4  
 100      =4  sfr16 CC1          = 0xC2;
 101      =4  sfr16 CC2          = 0xC4;
 102      =4  sfr16 CC3          = 0xC6;
 103      =4  sfr16 CRC          = 0xCA;
 104      =4  sfr16 T2           = 0xCC;
 105      =4  
 106      =4  //-----------------------------------------------------------------------------
 107      =4  /* Lint uses a trick (see co-kc51.lnt) where sbit gets treated like (expanded to) a bool.
 108      =4     This causes errors due to the strong type checking of _Bool (and thereby bool) that
 109      =4     is turned on in our implementation of stdbool.h.
 110      =4     Therefore, we suppress Lint warning 18 ("Redeclaration") for the sbit-s declared in this file.
 111      =4  */
 112      =4  
 113      =4  /*lint -e18 */
 114      =4  //-----------------------------------------------------------------------------
 115      =4  
 116      =4  //-----------------------------------------------------------------------------
 117      =4  // Bit Definitions
 118      =4  //-----------------------------------------------------------------------------
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 12  

 119      =4  
 120      =4  /*  FSR  */
 121      =4  sbit  MCDIS        = FSR^7;
 122      =4  sbit  STP          = FSR^6;
 123      =4  sbit  WEN          = FSR^5;
 124      =4  sbit  RDYN         = FSR^4;
 125      =4  sbit  INFEN        = FSR^3;
 126      =4  sbit  RDIS         = FSR^2;
 127      =4  sbit  RDEND        = FSR^1;
 128      =4  sbit  WPEN         = FSR^0;
 129      =4  
 130      =4  /*  PSW   */
 131      =4  sbit  CY           = PSW^7;
 132      =4  sbit  AC           = PSW^6;
 133      =4  sbit  F0           = PSW^5;
 134      =4  sbit  RS1          = PSW^4;
 135      =4  sbit  RS0          = PSW^3;
 136      =4  sbit  OV           = PSW^2;
 137      =4  sbit  F1           = PSW^1;
 138      =4  sbit  P            = PSW^0;
 139      =4  
 140      =4  /*  TCON  */
 141      =4  sbit  TF1          = TCON^7;
 142      =4  sbit  TR1          = TCON^6;
 143      =4  sbit  TF0          = TCON^5;
 144      =4  sbit  TR0          = TCON^4;
 145      =4  sbit  IE1          = TCON^3;
 146      =4  sbit  IT1          = TCON^2;
 147      =4  sbit  IE0          = TCON^1;
 148      =4  sbit  IT0          = TCON^0;
 149      =4  
 150      =4  /*  S0CON  */
 151      =4  sbit  SM0          = S0CON^7;
 152      =4  sbit  SM1          = S0CON^6;
 153      =4  sbit  SM20         = S0CON^5;
 154      =4  sbit  REN0         = S0CON^4;
 155      =4  sbit  TB80         = S0CON^3;
 156      =4  sbit  RB80         = S0CON^2;
 157      =4  sbit  TI0          = S0CON^1;
 158      =4  sbit  RI0          = S0CON^0;
 159      =4  
 160      =4  /*  T2CON  */
 161      =4  sbit  T2PS         = T2CON^7;
 162      =4  sbit  I3FR         = T2CON^6;
 163      =4  sbit  I2FR         = T2CON^5;
 164      =4  sbit  T2R1         = T2CON^4;
 165      =4  sbit  T2R0         = T2CON^3;
 166      =4  sbit  T2CM         = T2CON^2;
 167      =4  sbit  T2I1         = T2CON^1;
 168      =4  sbit  T2I0         = T2CON^0;
 169      =4  
 170      =4  /*  IEN0  */
 171      =4  sbit  EA           = IEN0^7;
 172      =4  
 173      =4  sbit  ET2          = IEN0^5;
 174      =4  sbit  ES0          = IEN0^4;
 175      =4  sbit  ET1          = IEN0^3;
 176      =4  sbit  EX1          = IEN0^2;
 177      =4  sbit  ET0          = IEN0^1;
 178      =4  sbit  EX0          = IEN0^0;
 179      =4  
 180      =4  /* IEN1  */
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 13  

 181      =4  sbit  EXEN2        = IEN1^7;
 182      =4  
 183      =4  sbit  WUIRQ        = IEN1^5;
 184      =4  sbit  USB          = IEN1^4;
 185      =4  sbit  USBWU        = IEN1^3;
 186      =4  sbit  SPI          = IEN1^2;
 187      =4  sbit  RF           = IEN1^1;
 188      =4  sbit  RFSPI        = IEN1^0;
 189      =4  
 190      =4  /* IRCON */
 191      =4  sbit  EXF2         = IRCON^7;
 192      =4  sbit  TF2          = IRCON^6;
 193      =4  sbit  WUF          = IRCON^5;
 194      =4  sbit  USBF         = IRCON^4;
 195      =4  sbit  USBWUF       = IRCON^3;
 196      =4  sbit  SPIF         = IRCON^2;
 197      =4  sbit  RFF          = IRCON^1;
 198      =4  sbit  RFSPIF       = IRCON^0;
 199      =4  
 200      =4  /* USBCON */
 201      =4  sbit  SWRST        = USBCON^7;
 202      =4  sbit  WU           = USBCON^6;
 203      =4  sbit  SUSPEND      = USBCON^5;
 204      =4  sbit  IV4          = USBCON^4;
 205      =4  sbit  IV3          = USBCON^3;
 206      =4  sbit  IV2          = USBCON^2;
 207      =4  sbit  IV1          = USBCON^1;
 208      =4  sbit  IV0          = USBCON^0;
 209      =4  
 210      =4  /* PORT0 */
 211      =4  sbit  P00          = P0^0;
 212      =4  sbit  P01          = P0^1;
 213      =4  sbit  P02          = P0^2;
 214      =4  sbit  P03          = P0^3;
 215      =4  sbit  MCSN         = P0^3;
 216      =4  sbit  SCSN         = P0^3;
 217      =4  sbit  P04          = P0^4;
 218      =4  sbit  P05          = P0^5;
 219      =4  
 220      =4  /* RFCON */
 221      =4  sbit  RFCE         = RFCON^0;
 222      =4  sbit  RFCSN        = RFCON^1;
 223      =4  sbit  RFCKEN       = RFCON^2;
 224      =4  
 225      =4  /* WDCON */
 226      =4  sbit  BD           = WDCON^7;
 227      =4  
 228      =4  /* AESCS */
 229      =4  sbit  GO           = AESCS^0;
 230      =4  sbit  DECR         = AESCS^1;
 231      =4  
 232      =4  /*lint +e18 */  /* Re-enable Lint warning 18 */
 233      =4  
 234      =4  
 235      =4  /* REGX commands */
 236      =4  #define RWD         0x00
 237      =4  #define WWD         0x08
 238      =4  #define RGTIMER     0x01
 239      =4  #define WGTIMER     0x09
 240      =4  #define RRTCLAT     0x02
 241      =4  #define WRTCLAT     0x0A
 242      =4  #define RRTC        0x03
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 14  

 243      =4  #define WRTCDIS     0x0B
 244      =4  #define RWSTA0      0x04
 245      =4  #define WWCON0      0x0C
 246      =4  #define RWSTA1      0x05
 247      =4  #define WWCON1      0x0D
 248      =4  
 249      =4  //-----------------------------------------------------------------------------
 250      =4  // Interrupt Vector Definitions
 251      =4  //-----------------------------------------------------------------------------
 252      =4  
 253      =4  #define INTERRUPT_EXT_INT0     0   // External Interrupt0 (P0.3)
 254      =4  #define INTERRUPT_T0           1   // Timer0 Overflow
 255      =4  #define INTERRUPT_AES_RDY      2   // AES ready interrupt
 256      =4  #define INTERRUPT_T1           3   // Timer1 Overflow
 257      =4  #define INTERRUPT_UART0        4   // UART0, Receive & Transmitt interrupt
 258      =4  #define INTERRUPT_T2           5   // Timer2 Overflow
 259      =4  #define INTERRUPT_RF_RDY       8   // RF SPI ready interrupt
 260      =4  #define INTERRUPT_RFIRQ        9   // RF interrupt
 261      =4  #define INTERRUPT_SPI          10  // SPI interrupt
 262      =4  #define INTERRUPT_USB_WU       11  // USB wakeup interrupt
 263      =4  #define INTERRUPT_USB_INT      12  // USB interrupt
 264      =4  #define INTERRUPT_WU           13  // Internal wakeup interrupt
 265      =4  
 266      =4  //-----------------------------------------------------------------------------
 267      =4  // Header File Preprocessor Directive
 268      =4  //-----------------------------------------------------------------------------
 269      =4  
 270      =4  #endif
  11      =3  #endif /*__C51__*/
  12      =3  
  13      =3  #include "isrdef24lu1p.h"
   1      =4  #ifdef __ICC8051__
           =4 
           =4 #define EXT_INT0_ISR() \
           =4 _Pragma("vector=0x0003") \
           =4 __interrupt void ext_int0_isr(void)
           =4 
           =4 #define T0_ISR() \
           =4 _Pragma("vector=0x000b") \
           =4 __interrupt void t0_isr(void)
           =4 
           =4 #define AES_RDY_ISR() \
           =4 _Pragma("vector=0x0013") \
           =4 __interrupt void aes_rdy_isr(void)
           =4 
           =4 #define T1_ISR() \
           =4 _Pragma("vector=0x001b") \
           =4 __interrupt void t1_isr(void)
           =4 
           =4 #define UART0_ISR() \
           =4 _Pragma("vector=0x0023") \
           =4 __interrupt void uart0_isr(void)
           =4 
           =4 #define T2_ISR() \
           =4 _Pragma("vector=0x002b") \
           =4 __interrupt void t2_isr(void)
           =4 
           =4 #define RF_RDY_ISR() \
           =4 _Pragma("vector=0x0043") \
           =4 __interrupt void rf_rdy_isr(void)
           =4 
           =4 #define NRF_ISR() \
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 15  

           =4 _Pragma("vector=0x004b") \
           =4 __interrupt void nrf_isr(void)
           =4 
           =4 #define SPI_ISR() \
           =4 _Pragma("vector=0x0053") \
           =4 __interrupt void spi_isr(void)
           =4 
           =4 #define USB_WU_ISR() \
           =4 _Pragma("vector=0x005b") \
           =4 __interrupt void usb_wu_isr(void)
           =4 
           =4 #define USB_ISR() \
           =4 _Pragma("vector=0x0063") \
           =4 __interrupt void usb_isr(void)
           =4 
           =4 #define WU_ISR() \
           =4 _Pragma("vector=0x006b") \
           =4 __interrupt void wu_isr(void)
           =4 
           =4 #endif /*__ICC8051__*/
  52      =4  
  53      =4  #ifdef __C51__
  54      =4  
  55      =4  #define EXT_INT0_ISR()  void ext_int0_isr(void) interrupt INTERRUPT_EXT_INT0// External Interrupt0 (P0.3) 
             -(0x03)
  56      =4  #define T0_ISR()        void t0_isr(void)       interrupt INTERRUPT_T0      // Timer0 Overflow (0x0b)
  57      =4  #define AES_RDY_ISR()   void aes_rdy_isr(void)  interrupt INTERRUPT_AES_RDY // AES ready interrupt (0x13)
  58      =4  #define T1_ISR()        void t1_isr(void)       interrupt INTERRUPT_T1      // Timer1 Overflow (0x1b)
  59      =4  #define UART0_ISR()     void uart0_isr(void)    interrupt INTERRUPT_UART0   // UART0, Receive & Transmitt 
             -interrupt (0x0023)
  60      =4  #define T2_ISR()        void t2_isr(void)       interrupt INTERRUPT_T2      // Timer2 Overflow (0x2b)
  61      =4  #define RF_RDY_ISR()    void rf_rdy_isr(void)   interrupt INTERRUPT_RF_RDY  // RF SPI ready interrupt (0x4
             -3)
  62      =4  #define NRF_ISR()       void nrf_isr(void)      interrupt INTERRUPT_RFIRQ   // RF interrupt (0x4b)
  63      =4  #define SPI_ISR()       void spi_isr(void)      interrupt INTERRUPT_SPI     // SPI interrupt (0x53)
  64      =4  #define USB_WU_ISR()    void usb_wu_isr(void)   interrupt INTERRUPT_USB_WU  // USB wakeup interrupt (0x5b)
  65      =4  #define USB_ISR()       void usb_isr(void)      interrupt INTERRUPT_USB_INT // USB interrupt (0x63)
  66      =4  #define WU_ISR()        void wu_isr(void)       interrupt INTERRUPT_WU      // Internal wakeup interrupt (
             -0x6b)
  67      =4  
  68      =4  #endif /*__C51__*/
  69      =4  
  70      =4  
  71      =4  
  72      =4  
  14      =3  #include "memdefs.h"
   1      =4  #ifndef MEMDEFS_H_
   2      =4  #define MEMDEFS_H_
   3      =4  
   4      =4  #ifdef __C51__
   5      =4  #define __no_init 
   6      =4  #endif /*__C51__*/
   7      =4  
   8      =4  #ifdef __ICC8051__
           =4 
           =4 #define idata __idata
           =4 #define xdata __xdata
           =4 #define code __code
           =4 #define data __data
           =4 #define pdata __pdata
           =4 #define _at_ @
           =4 #define _nop_() __no_operation()
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 16  

           =4 #define bit __bit
           =4 __sfr __no_init volatile unsigned int CRC @ 0xCA;
           =4 __sfr __no_init volatile unsigned int T2  @ 0xCC;
           =4 
           =4 #define reentrant 
           =4 #if __DATA_MODEL__ == __DATA_MODEL_LARGE__
           =4   #warning "if not using large data model: reentrant procedures must be declared using IAR syntax"
           =4 #endif /*__DATA_MODEL__ == __DATA_MODEL_LARGE__*/
           =4 
           =4 #define CLKCTRL CLKFCTL
           =4 
           =4 #ifndef NULL
           =4 #define NULL _NULL
           =4 #endif /*NULL*/
           =4 
           =4 #endif /*__ICC8051__*/
  33      =4  
  34      =4  #endif /*MEMDEFS_H_*/
  15      =3  
  16      =3  #endif
  26      =2  
  27      =2  /** Macro that set radio's CSN line LOW.
  28      =2   *
  29      =2   */
  30      =2  #define CSN_LOW() do { RFCSN = 0; } while(false)
  31      =2  
  32      =2  /** Macro that set radio's CSN line HIGH.
  33      =2   *
  34      =2   */
  35      =2  #define CSN_HIGH() do { RFCSN = 1; } while(false)
  36      =2  
  37      =2  /** Macro that set radio's CE line LOW.
  38      =2   *
  39      =2   */
  40      =2  #define CE_LOW() do { RFCE = 0; } while(false)
  41      =2  
  42      =2  /** Macro that set radio's CE line HIGH.
  43      =2   *
  44      =2   */
  45      =2  #define CE_HIGH() do { RFCE = 1; } while(false)
  46      =2  
  47      =2  /** Macro for writing the radio SPI data register.
  48      =2   *
  49      =2   */
  50      =2  #define HAL_NRF_HW_SPI_WRITE(d) do{RFDAT = d; RFSPIF = 0;} while(false)
  51      =2  
  52      =2  /** Macro for reading the radio SPI data register.
  53      =2   *
  54      =2   */
  55      =2  #define HAL_NRF_HW_SPI_READ() RFDAT
  56      =2    
  57      =2  /** Macro specifyng the radio SPI busy flag.
  58      =2   *
  59      =2   */
  60      =2  #define HAL_NRF_HW_SPI_BUSY (!RFSPIF)
  61      =2  
  62      =2  /**
  63      =2   * Pulses the CE to nRF24L01 for at least 10 us
  64      =2   */
  65      =2  #define CE_PULSE() do { \
  66      =2    uint8_t count; \
  67      =2    count = 20; \
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 17  

  68      =2    CE_HIGH();  \
  69      =2    while(count--){} \
  70      =2    CE_LOW();  \
  71      =2    } while(false)
  72      =2  
  73      =2  #endif // HAL_NRF_LU1_H__
  74      =2  
  75      =2  /** @} */
  49      =1  
  50      =1  /** @name Setup */
  51      =1  //@{
  52      =1  /* Setup function prototypes */
  53      =1  
  54      =1  /** Enable or disable interrupt for radio.
  55      =1   * Use this function to enable or disable
  56      =1   * one of the interrupt sources for the radio.
  57      =1   * This function only changes state for selected
  58      =1   * int_type, the rest of the interrupt sources
  59      =1   * are left unchanged.
  60      =1   *
  61      =1   * @param int_source Radio interrupt Source.
  62      =1   * @param irq_state Enable or Disable.
  63      =1  */
  64      =1  void hal_nrf_set_irq_mode(hal_nrf_irq_source_t int_source, bool irq_state);
  65      =1  
  66      =1  /* For the obsolete nRF24L01 it is necessary to issue an activate command before the
  67      =1   * features enabled by the FEATURE register can be used. For nRF24L01+ these features
  68      =1   * are by default enabled.
  69      =1  */
  70      =1  void hal_nrf_activate_features(void);
  71      =1  
  72      =1  /** Enables the dynamic packet length
  73      =1   * @param enable Whether enable or disable dynamic packet length
  74      =1   */
  75      =1  void hal_nrf_enable_dynamic_payload(bool enable);
  76      =1  
  77      =1  /** Enables the ACK payload feature
  78      =1   * @param enable Whether to enable or disable ACK payload
  79      =1   */
  80      =1  void hal_nrf_enable_ack_payload(bool enable);
  81      =1  
  82      =1  /** Enables the dynamic ack feature
  83      =1   * @param enable Whether to enable or disable Dynamic ACK
  84      =1   */
  85      =1  void hal_nrf_enable_dynamic_ack(bool enable);
  86      =1  
  87      =1  /** Function for enabling dynmic payload size.
  88      =1   * The input parameter contains is a byte where the bit values tells weather the
  89      =1   * pipe should use dynamic payload size. For example if bit 0 is set then 
  90      =1   * pipe 0 will accept dynamic payload size.
  91      =1   * @param setup Byte value telling for which pips(s) to enable dynamic payload size
  92      =1   */
  93      =1  void hal_nrf_setup_dynamic_payload(uint8_t setup);
  94      =1  
  95      =1  /** Reads the payload width of the received ack payload
  96      =1   * @return Payload width of the received ack payload
  97      =1   */
  98      =1  uint8_t hal_nrf_read_rx_payload_width(void);
  99      =1  
 100      =1  /** Write ack payload
 101      =1   * Writes the payload that will be transmitted with the ack on the given pipe.
 102      =1   * @param pipe Pipe that transmits the payload
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 18  

 103      =1   * @param tx_pload Pointer to the payload data
 104      =1   * @param length Size of the data to transmit
 105      =1   */
 106      =1  void hal_nrf_write_ack_payload(uint8_t pipe, const uint8_t *tx_pload, uint8_t length);
 107      =1  
 108      =1  /** Read then clears all interrupt flags.
 109      =1   * Use this function to get the interrupt flags and clear them in the same operation.
 110      =1   * Reduced radio interface activity and speed optimized.
 111      =1   *
 112      =1   * @return  Interrupt_flags
 113      =1   * @retval 0x10 Max Retransmit interrupt
 114      =1   * @retval 0x20 TX Data sent interrupt
 115      =1   * @retval 0x40 RX Data received interrupt
 116      =1  */
 117      =1  uint8_t hal_nrf_get_clear_irq_flags(void);
 118      =1  
 119      =1  uint8_t hal_nrf_clear_irq_flags_get_status(void);
 120      =1  
 121      =1  /** Clear one selected interrupt flag.
 122      =1   * Use this function to clear one @a spesific interrupt flag.
 123      =1   * Other interrupt flags are left unchanged.
 124      =1   *
 125      =1   * @param int_source Interrupt source of which flag to clear
 126      =1  */
 127      =1  void hal_nrf_clear_irq_flag(hal_nrf_irq_source_t int_source);
 128      =1  
 129      =1  /** Set the CRC mode used by the radio.
 130      =1   * Use this function to set the CRC mode; CRC disabled, 1 or 2 bytes.
 131      =1   *
 132      =1   * @param crc_mode CRC mode to use
 133      =1  */
 134      =1  void hal_nrf_set_crc_mode(hal_nrf_crc_mode_t crc_mode);
 135      =1  
 136      =1  /** Open radio pipe(s) and enable/ disable auto acknowledge.
 137      =1   * Use this function to open one or all pipes,
 138      =1   * with or without auto acknowledge.
 139      =1   *
 140      =1   * @param pipe_num Radio pipe to open
 141      =1   * @param auto_ack Auto_Ack ON/OFF
 142      =1   * @see hal_nrf_address
 143      =1  */
 144      =1  void hal_nrf_open_pipe(hal_nrf_address_t pipe_num, bool auto_ack);
 145      =1  
 146      =1  /** Close radio pipe(s).
 147      =1   * Use this function to close one pipe or all pipes.
 148      =1   *
 149      =1   * @param pipe_num Pipe# number to close
 150      =1  */
 151      =1  void hal_nrf_close_pipe(hal_nrf_address_t pipe_num);
 152      =1  
 153      =1  /** Set radio's RX address and TX address.
 154      =1   * Use this function to set a RX address, or to set the TX address.
 155      =1   * Beware of the difference for single and multibyte address registers.
 156      =1   *
 157      =1   * @param address Which address to set
 158      =1   * @param *addr Buffer from which the address is stored in
 159      =1  */
 160      =1  void hal_nrf_set_address(const hal_nrf_address_t address, const uint8_t *addr);
 161      =1  
 162      =1  /** Get address for selected pipe.
 163      =1   * Use this function to get address for selected pipe.
 164      =1   *
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 19  

 165      =1   *
 166      =1   * @param address Which address to get, Pipe- or TX-address
 167      =1   * @param *addr buffer in which address bytes are written.
 168      =1   * <BR><BR>For pipes containing only LSB byte of address, this byte is returned
 169      =1   * in the<BR> *addr buffer.
 170      =1   *
 171      =1   * @return Numbers of bytes copied to addr
 172      =1  */
 173      =1  uint8_t hal_nrf_get_address (uint8_t address, uint8_t *addr);
 174      =1  
 175      =1  /** Set auto acknowledge parameters.
 176      =1   * Use this function to set retransmit and retransmit delay
 177      =1   * parameters.
 178      =1   *
 179      =1   * @param retr Number of retransmit, 0 equ retransmit OFF
 180      =1   * @param delay Retransmit delay in s. Must be a 
 181      =1  */
 182      =1  void hal_nrf_set_auto_retr(uint8_t retr, uint16_t delay);
 183      =1  
 184      =1  /** Set radio's address width.
 185      =1   * Use this function to define the radio's address width,
 186      =1   * referes to both RX and TX.
 187      =1   *
 188      =1   * @param address_width Address with in bytes
 189      =1  */
 190      =1  void hal_nrf_set_address_width(hal_nrf_address_width_t address_width);
 191      =1  
 192      =1  /** Gets the radio's address width.
 193      =1   *
 194      =1   * @return Address width
 195      =1   */
 196      =1  uint8_t hal_nrf_get_address_width (void);
 197      =1  
 198      =1  /** Set payload width for selected pipe.
 199      =1   * Use this function to set the number of bytes expected
 200      =1   * on a selected pipe.
 201      =1   *
 202      =1   * @param pipe_num Pipe number to set payload width for
 203      =1   * @param pload_width number of bytes expected
 204      =1  */
 205      =1  void hal_nrf_set_rx_payload_width(uint8_t pipe_num, uint8_t pload_width);
 206      =1  
 207      =1  /** Read current interrupt mode for selected interrupt source.
 208      =1   * Use this function to get the interrupt source's mode,
 209      =1   * either enabled or disabled.
 210      =1   *
 211      =1   * @param int_source Interrupt source to get mode from
 212      =1   *
 213      =1   * @return Interrupt Mode
 214      =1   * @retval FALSE Interrupt disabled
 215      =1   * @retval TRUE Interrupt enabled
 216      =1  */
 217      =1  bool hal_nrf_get_irq_mode(uint8_t int_source);
 218      =1  
 219      =1  /** Read all interrupt flags.
 220      =1   * Use this function to get the interrupt flags. This function is similar
 221      =1   * to hal_nrf_get_clear_irq_flags with the exception that it does <I><B>NOT</B></I> clear
 222      =1   * the irq_flags.
 223      =1   *
 224      =1   * @return Interrupt_flags
 225      =1   * @retval 0x10 Max Retransmit interrupt
 226      =1   * @retval 0x20 TX Data sent interrupt
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 20  

 227      =1   * @retval 0x40 RX Data received interrupt
 228      =1  */
 229      =1  uint8_t hal_nrf_get_irq_flags(void);
 230      =1  
 231      =1  /** Get pipe status.
 232      =1   * Use this function to check status for a selected pipe.
 233      =1   *
 234      =1   * @param  pipe_num Pipe number to check status for
 235      =1   *
 236      =1   * @return Pipe_Status
 237      =1   * @retval 0x00 Pipe is closed, autoack disabled
 238      =1   * @retval 0x01 Pipe is open, autoack disabled
 239      =1   * @retval 0x03 Pipe is open, autoack enabled
 240      =1  */
 241      =1  uint8_t hal_nrf_get_pipe_status(uint8_t pipe_num);
 242      =1  
 243      =1  /** Get auto retransmit parameters.
 244      =1   * Use this function to get the auto retransmit parameters,
 245      =1   * retrans count and retrans delay.
 246      =1   *
 247      =1   * @return AutoRetrans Parameters
 248      =1   *
 249      =1   * @retval UpperNibble Retransmit Delay
 250      =1   * @retval LowerNibble Retransmit Count
 251      =1  */
 252      =1  uint8_t hal_nrf_get_auto_retr_status(void);
 253      =1  
 254      =1  /** Get packet lost counter
 255      =1   * Use this function to get the packet(s) counter.
 256      =1   *
 257      =1   * @return packet lost counter
 258      =1  */
 259      =1  uint8_t hal_nrf_get_packet_lost_ctr(void);
 260      =1  
 261      =1  /** Get RX payload width for selected pipe.
 262      =1   * Use this function to get the expected payload
 263      =1   * width for selected ppe number.
 264      =1   *
 265      =1   * @param pipe_num Pipe number to get payload width for
 266      =1   *
 267      =1   * @return Payload_Width in bytes
 268      =1  */
 269      =1  uint8_t hal_nrf_get_rx_payload_width(uint8_t pipe_num);
 270      =1  //@}
 271      =1  
 272      =1  /** @name Operation */
 273      =1  //@{
 274      =1  /* Operation function prototypes */
 275      =1  
 276      =1  /** Set radio's operation mode.
 277      =1   * Use this function to enter PTX (primary TX)
 278      =1   * or PRX (primary RX).
 279      =1   *
 280      =1   * @param op_mode Operation mode
 281      =1  */
 282      =1  void hal_nrf_set_operation_mode(hal_nrf_operation_mode_t op_mode);
 283      =1  
 284      =1  /** Set radio's power mode.
 285      =1   * Use this function to power_up or power_down radio.
 286      =1   *
 287      =1   * @param pwr_mode POWER_UP or POWER_DOWN
 288      =1  */
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 21  

 289      =1  void hal_nrf_set_power_mode(hal_nrf_pwr_mode_t pwr_mode);
 290      =1  
 291      =1  /** Set radio's RF channel.
 292      =1   * Use this function to select which RF channel to use.
 293      =1   *
 294      =1   * @param channel RF channel
 295      =1  */
 296      =1  void hal_nrf_set_rf_channel(uint8_t channel);
 297      =1  
 298      =1  /** Set radio's TX output power.
 299      =1   * Use this function set the radio's TX output power.
 300      =1   *
 301      =1   * @param power Radio's TX output power
 302      =1  */
 303      =1  void hal_nrf_set_output_power(hal_nrf_output_power_t power);
 304      =1  
 305      =1  /** Set radio's on-air datarate.
 306      =1   * Use this function to select radio's on-air
 307      =1   * datarate.
 308      =1   *
 309      =1   * @param datarate On-air datarate
 310      =1  */
 311      =1  void hal_nrf_set_datarate(hal_nrf_datarate_t datarate);
 312      =1  
 313      =1  
 314      =1  /* Status functions prototypes */
 315      =1  
 316      =1  /** Get radio's TX FIFO status.
 317      =1   * Use this function to get the radio's TX
 318      =1   * FIFO status.
 319      =1   *
 320      =1   * @return TX FIFO status
 321      =1   * @retval 0x00 TX FIFO NOT empty, but NOT full
 322      =1   * @retval 0x01 FIFO empty
 323      =1   * @retval 0x02 FIFO full
 324      =1   *
 325      =1  */
 326      =1  uint8_t hal_nrf_get_tx_fifo_status(void);
 327      =1  
 328      =1  /** Check for TX FIFO empty.
 329      =1   * Use this function to check if TX FIFO
 330      =1   * is empty.
 331      =1   *
 332      =1   * @return TX FIFO empty bit
 333      =1   * @retval FALSE TX FIFO NOT empty
 334      =1   * @retval TRUE TX FIFO empty
 335      =1   *
 336      =1  */
 337      =1  bool hal_nrf_tx_fifo_empty(void);
 338      =1  
 339      =1  /** Check for TX FIFO full.
 340      =1   * Use this function to check if TX FIFO
 341      =1   * is full.
 342      =1   *
 343      =1   * @return TX FIFO full bit
 344      =1   * @retval FALSE TX FIFO NOT full
 345      =1   * @retval TRUE TX FIFO full
 346      =1   *
 347      =1  */
 348      =1  bool hal_nrf_tx_fifo_full(void);
 349      =1  
 350      =1  /** Get radio's RX FIFO status.
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 22  

 351      =1   * Use this function to get the radio's TX
 352      =1   * FIFO status.
 353      =1   *
 354      =1   * @return RX FIFO status
 355      =1   * @retval 0x00 RX FIFO NOT empty, but NOT full
 356      =1   * @retval 0x01 RX FIFO empty
 357      =1   * @retval 0x02 RX FIFO full
 358      =1   *
 359      =1  */
 360      =1  uint8_t hal_nrf_get_rx_fifo_status(void);
 361      =1  
 362      =1  /** Check for RX FIFO empty.
 363      =1   * Use this function to check if RX FIFO
 364      =1   * is empty.
 365      =1   *
 366      =1   * Reads STATUS register to check this, not FIFO_STATUS  
 367      =1   *
 368      =1   * @return RX FIFO empty bit
 369      =1   * @retval FALSE RX FIFO NOT empty
 370      =1   * @retval TRUE RX FIFO empty
 371      =1   *
 372      =1  */
 373      =1  bool hal_nrf_rx_fifo_empty(void);
 374      =1  
 375      =1  /** Check for RX FIFO full.
 376      =1   * Use this function to check if RX FIFO
 377      =1   * is full.
 378      =1   *
 379      =1   * @return RX FIFO full bit
 380      =1   * @retval FALSE RX FIFO NOT full
 381      =1   * @retval TRUE RX FIFO full
 382      =1   *
 383      =1  */
 384      =1  bool hal_nrf_rx_fifo_full(void);
 385      =1  
 386      =1  /** Get radio's transmit attempts status.
 387      =1   * Use this function to get number of retransmit
 388      =1   * attempts and number of packet lost.
 389      =1   *
 390      =1   * @return Retransmit attempts counters
 391      =1  */
 392      =1  uint8_t hal_nrf_get_transmit_attempts(void);
 393      =1  
 394      =1  /** Get the carrier detect flag.
 395      =1   * Use this function to get the carrier detect flag,
 396      =1   * used to detect stationary disturbance on selected
 397      =1   * RF channel.
 398      =1   *
 399      =1   * @return Carrier Detect
 400      =1   * @retval FALSE Carrier NOT Detected
 401      =1   * @retval TRUE Carrier Detected
 402      =1  */
 403      =1  bool hal_nrf_get_carrier_detect(void);
 404      =1  
 405      =1  /* Data operation prototypes */
 406      =1  
 407      =1  /** Get RX data source.
 408      =1   * Use this function to read which RX pipe data
 409      =1   * was received on for current top level FIFO data packet.
 410      =1   *
 411      =1   * @return pipe number of current packet present
 412      =1  */
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 23  

 413      =1  uint8_t hal_nrf_get_rx_data_source(void);
 414      =1  
 415      =1  /** Read RX payload.
 416      =1   * Use this function to read top level payload
 417      =1   * available in the RX FIFO.
 418      =1   *
 419      =1   * @param  *rx_pload pointer to buffer in which RX payload are stored
 420      =1   * @return pipe number (MSB byte) and packet length (LSB byte)
 421      =1  */
 422      =1  uint16_t hal_nrf_read_rx_payload(uint8_t *rx_pload);
 423      =1  
 424      =1  /** Write TX payload to radio.
 425      =1   * Use this function to write a packet of
 426      =1   * TX payload into the radio.
 427      =1   * <I>length</I> number of bytes, which are stored in <I>*tx_pload</I>.
 428      =1   *
 429      =1   * @param *tx_pload pointer to buffer in which TX payload are present
 430      =1   * @param length number of bytes to write
 431      =1  */
 432      =1  void hal_nrf_write_tx_payload(const uint8_t *tx_pload, uint8_t length);
 433      =1  
 434      =1  /** Write TX payload which do not require ACK. When transmitting 
 435      =1   * a ACK is not required nor sent from the receiver. The payload will
 436      =1   * always be assumed as "sent".
 437      =1   *
 438      =1   * Use this function to write a packet of
 439      =1   * TX payload into the radio.
 440      =1   * <I>length</I> number of bytes, which are stored in <I>*tx_pload</I>.
 441      =1   *
 442      =1   * @param *tx_pload pointer to buffer in which TX payload are present
 443      =1   * @param length number of bytes to write
 444      =1  */
 445      =1  void hal_nrf_write_tx_payload_noack(const uint8_t *tx_pload, uint8_t length);
 446      =1  
 447      =1  /** Reuse TX payload.
 448      =1   * Use this function to set that the radio is using
 449      =1   * the last transmitted payload for the next packet as well.
 450      =1   *
 451      =1  */
 452      =1  void hal_nrf_reuse_tx(void);
 453      =1  
 454      =1  /** Get status of reuse TX function.
 455      =1   * Use this function to check if reuse TX payload is
 456      =1   * activated
 457      =1   *
 458      =1   * @return Reuse TX payload mode
 459      =1   * @retval FALSE Not activated
 460      =1   * @retval TRUE Activated
 461      =1  */
 462      =1  bool hal_nrf_get_reuse_tx_status(void);
 463      =1  
 464      =1  /** Flush RX FIFO.
 465      =1   * Use this function to flush the radio's
 466      =1   * RX FIFO.
 467      =1   *
 468      =1  */
 469      =1  void hal_nrf_flush_rx(void);
 470      =1  
 471      =1  /** Flush TX FIFO.
 472      =1   * Use this function to flush the radio's
 473      =1   * TX FIFO.
 474      =1   *
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 24  

 475      =1  */
 476      =1  void hal_nrf_flush_tx(void);
 477      =1  
 478      =1  /** No Operation command.
 479      =1   * Use this function to receive the radio's
 480      =1   * status register.
 481      =1   *
 482      =1   * @return Status register
 483      =1  */
 484      =1  uint8_t hal_nrf_nop(void);
 485      =1  //@}
 486      =1  
 487      =1  /** @name  Test */
 488      =1  //@{
 489      =1  /* Test functions prototypes */
 490      =1  
 491      =1  /** Set radio's PLL mode.
 492      =1   * Use this function to either LOCK
 493      =1   * or UNLOCK the radio's PLL.
 494      =1   *
 495      =1   * @param pll_lock PLL locked, TRUE or FALSE
 496      =1  */
 497      =1  void hal_nrf_set_pll_mode(bool pll_lock);
 498      =1  
 499      =1  /** Set radio's LNA gain mode.
 500      =1   * Use this function to either use HI
 501      =1   * current or LOW current mode for the radio.
 502      =1   *
 503      =1   * @param lna_gain LNA gain mode
 504      =1  */
 505      =1  void hal_nrf_set_lna_gain(bool lna_gain);
 506      =1  
 507      =1  /** Enables continuous carrier transmit.
 508      =1   * Use this function to enable or disable
 509      =1   * continuous carrier transmission.
 510      =1   * @param enable Enable continuous carrier
 511      =1   */
 512      =1  void hal_nrf_enable_continious_wave (bool enable);
 513      =1  
 514      =1  /* hal_nrf_l01 basic functions, used by all the other functions */
 515      =1  
 516      =1  //@}
 517      =1  
 518      =1  /** @name SPI interface */
 519      =1  //@{
 520      =1  
 521      =1  /** Basis function, nrf_rw
 522      =1   * This function is used by the basis functions
 523      =1   * to exchange data with the data.
 524      =1   *
 525      =1   * @param value Databyte to write
 526      =1   *
 527      =1   * @return Databyte from radio.
 528      =1  */
 529      =1  uint8_t hal_nrf_rw(uint8_t value);
 530      =1  //@}
 531      =1  #endif // HAL_NRF_H__
 532      =1  /** @} */
 533      =1  
  28          
  29          #define SET_BIT(pos) ((uint8_t) (1<<( (uint8_t) (pos) )))
  30          #define UINT8(t) ((uint8_t) (t))
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 25  

  31          
  32          /** Basis function read_reg.
  33           * Use this function to read the contents
  34           * of one radios register.
  35           *
  36           * @param reg Register to read
  37           * @return Register contents
  38          */
  39          uint8_t hal_nrf_read_reg(uint8_t reg);
  40          
  41          /** Basis function write_reg.
  42           * Use this function to write a new value to
  43           * a radio register.
  44           *
  45           * @param reg Register to write
  46           * @param value New value to write
  47           * @return Status register
  48          */
  49          uint8_t hal_nrf_write_reg(uint8_t reg, uint8_t value);
  50          
  51          /** Basis function, read_multibyte register .
  52           * Use this function to read multiple bytes from
  53           * a multibyte radio-register
  54           *
  55           * @param reg Multibyte register to read from
  56           * @param *pbuf Pointer to buffer in which to store read bytes to
  57           *
  58           * @return pipe# of received data (MSB), if operation used by a hal_nrf_read_rx_pload
  59           * @return length of read data (LSB), either for hal_nrf_read_rx_pload or
  60           * for hal_nrf_get_address.
  61          */
  62          uint16_t hal_nrf_read_multibyte_reg(uint8_t reg, uint8_t *pbuf);
  63          
  64          /** Basis function, write_multibyte register.
  65           * Use this function to write multiple bytes to
  66           * a multiple radio register.
  67           *
  68           * @param reg Register to write
  69           * @param *pbuf pointer to buffer in which data to write is
  70           * @param length \# of bytes to write
  71          */
  72          void hal_nrf_write_multibyte_reg(uint8_t reg, const uint8_t *pbuf, uint8_t length);
  73          
  74          /**
  75           * Typedef for the CONFIG register. Contains all the bitaddressable
  76           * settings in the bits struct and the value sent to the radio in the uint8_t
  77           */
  78          typedef union {
  79            uint8_t value;
  80                  struct {
  81                          uint8_t prim_rx : 1;
  82                          uint8_t pwr_up : 1;
  83                          uint8_t crc0 : 1;
  84                          uint8_t en_crc : 1;
  85                          uint8_t mask_max_rt : 1;
  86                          uint8_t mask_tx_ds : 1;
  87                          uint8_t mask_rx_dr : 1;
  88                          const uint8_t : 1;
  89                  } bits;
  90          } config_t;
  91          
  92          /**
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 26  

  93           * Typedef for the EN_AA, EN_RXADDR and DYNPD registers. Contains all the
  94           * bitaddressable settings in the bits struct and the value sent to the radio
  95           * in the uint8_t
  96           */
  97          typedef union {
  98            uint8_t value;
  99            struct {
 100              uint8_t pipe_0 : 1;
 101              uint8_t pipe_1 : 1;
 102              uint8_t pipe_2 : 1;
 103              uint8_t pipe_3 : 1;
 104              uint8_t pipe_4 : 1;
 105              uint8_t pipe_5 : 1;
 106              const uint8_t : 2;
 107            } bits;
 108          } en_pipes_t;
 109          
 110          /**
 111           * Typedef for the SETUP_AW register. Contains all the bitaddressable
 112           * settings in the bits struct and the value sent to the radio in the uint8_t
 113           */
 114          typedef union {
 115            uint8_t value;
 116                  struct {
 117                          uint8_t aw : 2;
 118                          const uint8_t : 6;
 119                  } bits;
 120          } setup_aw_t;
 121          
 122          /**
 123           * Typedef for the SETUP_RETR register. Contains all the bitaddressable
 124           * settings in the bits struct and the value sent to the radio in the uint8_t
 125           */
 126          typedef union {
 127            uint8_t value;
 128                  struct {
 129                          uint8_t arc : 4;
 130                          uint8_t ard : 4;
 131                  } bits;
 132          } setup_retr_t;
 133          
 134          /**
 135           * Typedef for the RF_CH register. Contains all the bitaddressable
 136           * settings in the bits struct and the value sent to the radio in the uint8_t
 137           */
 138          typedef union {
 139            uint8_t value;
 140                  struct {
 141                          uint8_t rf_ch : 7;
 142                          const uint8_t : 1;
 143                  } bits;
 144          } rf_ch_t;
 145          
 146          /**
 147           * Typedef for the RF_SETUP register. Contains all the bitaddressable
 148           * settings in the bits struct and the value sent to the radio in the uint8_t
 149           */
 150          typedef union {
 151            uint8_t value;
 152                  struct {
 153                          const uint8_t : 1;
 154                          uint8_t rf_pwr : 2;
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 27  

 155                          uint8_t rf_dr_high : 1;
 156                          uint8_t pll_lock : 1;
 157                          uint8_t rf_dr_low : 1;
 158              const uint8_t : 1;
 159              uint8_t cont_wave : 1;
 160                  } bits;
 161          } rf_setup_t;
 162          
 163          /**
 164           * Typedef for the RX_PW_Px registers. Contains all the bitaddressable
 165           * settings in the bits struct and the value sent to the radio in the uint8_t
 166           */
 167          typedef union {
 168            uint8_t value;
 169                  struct {
 170                          uint8_t rx_pw : 6;
 171                          const uint8_t : 2;
 172                  } bits;
 173          } rx_pw_t;
 174          
 175          /**
 176           * Typedef for the FEATURE register. Contains all the bitaddressable
 177           * settings in the bits struct and the value sent to the radio in the uint8_t
 178           */
 179          typedef union {
 180            uint8_t value;
 181                  struct {
 182                          uint8_t en_dyn_ack : 1;
 183                          uint8_t en_ack_pay : 1;
 184                          uint8_t en_dpl : 1;
 185                          const uint8_t : 5;
 186                  } bits;
 187          } feature_t;
 188          
 189          void hal_nrf_set_operation_mode(hal_nrf_operation_mode_t op_mode)
 190          {
 191   1        config_t config;
 192   1        config.value = hal_nrf_read_reg (CONFIG);
 193   1      
 194   1        if(op_mode == HAL_NRF_PRX)
 195   1        {
 196   2          config.bits.prim_rx = 1;
 197   2        }
 198   1        else
 199   1        {
 200   2          config.bits.prim_rx = 0;
 201   2        }
 202   1      
 203   1        hal_nrf_write_reg (CONFIG, config.value);
 204   1      }
 205          
 206          void hal_nrf_set_power_mode(hal_nrf_pwr_mode_t pwr_mode)
 207          {
 208   1        config_t config;
 209   1        config.value = hal_nrf_read_reg (CONFIG);
 210   1      
 211   1        if(pwr_mode == HAL_NRF_PWR_UP)
 212   1        {
 213   2          config.bits.pwr_up = 1;
 214   2        }
 215   1        else
 216   1        {
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 28  

 217   2          config.bits.pwr_up = 0;
 218   2        }
 219   1      
 220   1        hal_nrf_write_reg (CONFIG, config.value);
 221   1      }
 222          
 223          void hal_nrf_set_crc_mode(hal_nrf_crc_mode_t crc_mode)
 224          {
 225   1        config_t config;
 226   1        config.value = hal_nrf_read_reg (CONFIG);
 227   1      
 228   1              switch (crc_mode)
 229   1              {
 230   2                      case HAL_NRF_CRC_OFF:
 231   2                              config.bits.en_crc = 0;
 232   2                              break;
 233   2                      case HAL_NRF_CRC_8BIT:
 234   2                              config.bits.en_crc = 1;
 235   2                              config.bits.crc0 = 0;
 236   2                              break;
 237   2                      case HAL_NRF_CRC_16BIT:
 238   2                              config.bits.en_crc = 1;
 239   2                              config.bits.crc0 = 1;
 240   2                              break;
 241   2                      default:
 242   2                              break;
 243   2              }
 244   1      
 245   1        hal_nrf_write_reg (CONFIG, config.value);
 246   1      }
 247          
 248          void hal_nrf_set_irq_mode(hal_nrf_irq_source_t int_source, bool irq_state)
 249          {
 250   1        config_t config;
 251   1        config.value = hal_nrf_read_reg (CONFIG);
 252   1      
 253   1              switch (int_source)
 254   1              {
 255   2                      case HAL_NRF_MAX_RT:
 256   2                              config.bits.mask_max_rt = irq_state ? 0 : 1;
 257   2            break;
 258   2          case HAL_NRF_TX_DS:
 259   2            config.bits.mask_tx_ds = irq_state ? 0 : 1;
 260   2            break;
 261   2          case HAL_NRF_RX_DR:
 262   2            config.bits.mask_rx_dr = irq_state ? 0 : 1;
 263   2            break;
 264   2        }
 265   1      
 266   1        hal_nrf_write_reg (CONFIG, config.value);
 267   1      }
 268          
 269          uint8_t hal_nrf_get_clear_irq_flags(void)
 270          {
 271   1        uint8_t retval;
 272   1      
 273   1        retval = hal_nrf_write_reg (STATUS, (BIT_6|BIT_5|BIT_4));
 274   1      
 275   1        return (retval & (BIT_6|BIT_5|BIT_4));
 276   1      }
 277          
 278          uint8_t hal_nrf_clear_irq_flags_get_status(void)
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 29  

 279          {
 280   1        uint8_t retval;
 281   1      
 282   1        // When RFIRQ is cleared (when calling write_reg), pipe information is unreliable (read again with read_
             -reg)
 283   1        retval = hal_nrf_write_reg (STATUS, (BIT_6|BIT_5|BIT_4)) & (BIT_6|BIT_5|BIT_4);
 284   1        retval |= hal_nrf_read_reg (STATUS) & (BIT_3|BIT_2|BIT_1|BIT_0);
 285   1      
 286   1        return (retval);
 287   1      }
 288          
 289          
 290          void hal_nrf_clear_irq_flag(hal_nrf_irq_source_t int_source)
 291          {
 292   1        hal_nrf_write_reg (STATUS, SET_BIT(int_source));
 293   1      }
 294          
 295          uint8_t hal_nrf_get_irq_flags(void)
 296          {
 297   1        return hal_nrf_nop() & (BIT_6|BIT_5|BIT_4);
 298   1      }
 299          
 300          void hal_nrf_open_pipe(hal_nrf_address_t pipe_num, bool auto_ack)
 301          {
 302   1        en_pipes_t en_rxaddr;
 303   1        en_pipes_t en_aa;
 304   1        en_rxaddr.value = hal_nrf_read_reg (EN_RXADDR);
 305   1        en_aa.value = hal_nrf_read_reg (EN_AA);
 306   1      
 307   1        switch(pipe_num)
 308   1        {
 309   2          case HAL_NRF_PIPE0:
 310   2          case HAL_NRF_PIPE1:
 311   2          case HAL_NRF_PIPE2:
 312   2          case HAL_NRF_PIPE3:
 313   2          case HAL_NRF_PIPE4:
 314   2          case HAL_NRF_PIPE5:
 315   2            en_rxaddr.value = en_rxaddr.value | SET_BIT(pipe_num);
 316   2      
 317   2            if(auto_ack)
 318   2            {
 319   3              en_aa.value = en_aa.value | SET_BIT(pipe_num);
 320   3            }
 321   2            else
 322   2            {
 323   3              en_aa.value = en_aa.value & ~SET_BIT(pipe_num);
 324   3            }
 325   2            break;
 326   2      
 327   2          case HAL_NRF_ALL:
 328   2            en_rxaddr.value = (uint8_t)(~(BIT_6|BIT_7));
 329   2      
 330   2            if(auto_ack)
 331   2            {
 332   3              en_aa.value = (uint8_t)(~(BIT_6|BIT_7));
 333   3            }
 334   2            else
 335   2            {
 336   3              en_aa.value = 0;
 337   3            }
 338   2            break;
 339   2      
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 30  

 340   2          case HAL_NRF_TX:
 341   2          default:
 342   2            break;
 343   2        }
 344   1      
 345   1        hal_nrf_write_reg (EN_RXADDR, en_rxaddr.value);
 346   1        hal_nrf_write_reg (EN_AA, en_aa.value);
 347   1      }
 348          
 349          void hal_nrf_close_pipe(hal_nrf_address_t pipe_num)
 350          {
 351   1        en_pipes_t en_rxaddr;
 352   1        en_pipes_t en_aa;
 353   1        en_rxaddr.value = hal_nrf_read_reg (EN_RXADDR);
 354   1        en_aa.value = hal_nrf_read_reg (EN_AA);
 355   1      
 356   1        switch(pipe_num)
 357   1        {
 358   2          case HAL_NRF_PIPE0:
 359   2          case HAL_NRF_PIPE1:
 360   2          case HAL_NRF_PIPE2:
 361   2          case HAL_NRF_PIPE3:
 362   2          case HAL_NRF_PIPE4:
 363   2          case HAL_NRF_PIPE5:
 364   2            en_rxaddr.value = en_rxaddr.value & ~SET_BIT(pipe_num);
 365   2            en_aa.value = en_aa.value & ~SET_BIT(pipe_num);
 366   2            break;
 367   2      
 368   2          case HAL_NRF_ALL:
 369   2            en_rxaddr.value = 0;
 370   2            en_aa.value = 0;
 371   2            break;
 372   2      
 373   2          case HAL_NRF_TX:
 374   2          default:
 375   2            break;
 376   2        }
 377   1      
 378   1        hal_nrf_write_reg (EN_RXADDR, en_rxaddr.value);
 379   1        hal_nrf_write_reg (EN_AA, en_aa.value);
 380   1      }
 381          
 382          void hal_nrf_set_address(const hal_nrf_address_t address, const uint8_t *addr)
 383          {
 384   1        switch(address)
 385   1        {
 386   2          case HAL_NRF_TX:
 387   2          case HAL_NRF_PIPE0:
 388   2          case HAL_NRF_PIPE1:
 389   2            hal_nrf_write_multibyte_reg(W_REGISTER + RX_ADDR_P0 + (uint8_t) address, addr, hal_nrf_get_address_w
             -idth());
 390   2            break;
 391   2          case HAL_NRF_PIPE2:
 392   2          case HAL_NRF_PIPE3:
 393   2          case HAL_NRF_PIPE4:
 394   2          case HAL_NRF_PIPE5:
 395   2            hal_nrf_write_reg (RX_ADDR_P0 + (uint8_t) address, *addr);
 396   2            break;
 397   2      
 398   2          case HAL_NRF_ALL:
 399   2          default:
 400   2            break;
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 31  

 401   2        }
 402   1      }
 403          
 404          uint8_t hal_nrf_get_address(uint8_t address, uint8_t *addr)
 405          {
 406   1        switch (address)
 407   1        {
 408   2          case HAL_NRF_PIPE0:
 409   2          case HAL_NRF_PIPE1:
 410   2          case HAL_NRF_TX:
 411   2            return (uint8_t)hal_nrf_read_multibyte_reg (address, addr);
 412   2          default:
 413   2            *addr = hal_nrf_read_reg(RX_ADDR_P0 + address);
 414   2            return 1;
 415   2        }
 416   1      }
 417          
 418          void hal_nrf_set_auto_retr(uint8_t retr, uint16_t delay)
 419          {
 420   1        setup_retr_t setup_retr;
 421   1        setup_retr.bits.ard = (delay >> 8);
 422   1        setup_retr.bits.arc = retr;
 423   1      
 424   1        hal_nrf_write_reg (SETUP_RETR, setup_retr.value);
 425   1      }
 426          
 427          void hal_nrf_set_address_width(hal_nrf_address_width_t aw)
 428          {
 429   1        setup_aw_t setup_aw;
 430   1        setup_aw.bits.aw = (uint8_t)aw - 2;
 431   1      
 432   1        hal_nrf_write_reg (SETUP_AW, setup_aw.value);
 433   1      }
 434          
 435          uint8_t hal_nrf_get_address_width (void)
 436          {
 437   1        return hal_nrf_read_reg (SETUP_AW) + 2;
 438   1      }
 439          
 440          void hal_nrf_set_rx_payload_width(uint8_t pipe_num, uint8_t pload_width)
 441          {
 442   1        hal_nrf_write_reg (RX_PW_P0 + pipe_num, pload_width);
 443   1      }
 444          
 445          uint8_t hal_nrf_get_pipe_status(uint8_t pipe_num)
 446          {
 447   1        en_pipes_t en_rxaddr;
 448   1        en_pipes_t en_aa;
 449   1        uint8_t en_rx_r, en_aa_r;
 450   1      
 451   1        en_rxaddr.value = hal_nrf_read_reg (EN_RXADDR);
 452   1        en_aa.value = hal_nrf_read_reg (EN_AA);
 453   1      
 454   1        switch (pipe_num)
 455   1        {
 456   2          case 0:
 457   2            en_rx_r = en_rxaddr.bits.pipe_0;
 458   2            en_aa_r = en_aa.bits.pipe_0;
 459   2            break;
 460   2          case 1:
 461   2            en_rx_r = en_rxaddr.bits.pipe_1;
 462   2            en_aa_r = en_aa.bits.pipe_1;
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 32  

 463   2            break;
 464   2          case 2:
 465   2            en_rx_r = en_rxaddr.bits.pipe_2;
 466   2            en_aa_r = en_aa.bits.pipe_2;
 467   2            break;
 468   2          case 3:
 469   2            en_rx_r = en_rxaddr.bits.pipe_3;
 470   2            en_aa_r = en_aa.bits.pipe_3;
 471   2            break;
 472   2          case 4:
 473   2            en_rx_r = en_rxaddr.bits.pipe_4;
 474   2            en_aa_r = en_aa.bits.pipe_4;
 475   2            break;
 476   2          case 5:
 477   2            en_rx_r = en_rxaddr.bits.pipe_5;
 478   2            en_aa_r = en_aa.bits.pipe_5;
 479   2            break;
 480   2          default:
 481   2            en_rx_r = 0;
 482   2            en_aa_r = 0;
 483   2            break;
 484   2        }
 485   1      
 486   1        return (uint8_t)(en_aa_r << 1) + en_rx_r;
 487   1      }
 488          
 489          uint8_t hal_nrf_get_auto_retr_status(void)
 490          {
 491   1        return hal_nrf_read_reg(OBSERVE_TX);
 492   1      }
 493          
 494          uint8_t hal_nrf_get_packet_lost_ctr(void)
 495          {
 496   1        return ((hal_nrf_read_reg(OBSERVE_TX) & (BIT_7|BIT_6|BIT_5|BIT_4)) >> 4);
 497   1      }
 498          
 499          uint8_t hal_nrf_get_rx_payload_width(uint8_t pipe_num)
 500          {
 501   1        uint8_t pw;
 502   1      
 503   1        switch (pipe_num)
 504   1        {
 505   2          case 0:
 506   2            pw = hal_nrf_read_reg (RX_PW_P0);
 507   2            break;
 508   2          case 1:
 509   2            pw = hal_nrf_read_reg (RX_PW_P1);
 510   2            break;
 511   2          case 2:
 512   2            pw = hal_nrf_read_reg (RX_PW_P2);
 513   2            break;
 514   2          case 3:
 515   2            pw = hal_nrf_read_reg (RX_PW_P3);
 516   2            break;
 517   2          case 4:
 518   2            pw = hal_nrf_read_reg (RX_PW_P4);
 519   2            break;
 520   2          case 5:
 521   2            pw = hal_nrf_read_reg (RX_PW_P5);
 522   2            break;
 523   2          default:
 524   2            pw = 0;
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 33  

 525   2            break;
 526   2        }
 527   1      
 528   1        return pw;
 529   1      }
 530          
 531          void hal_nrf_set_rf_channel(uint8_t channel)
 532          {
 533   1        rf_ch_t rf_ch;
 534   1        rf_ch.bits.rf_ch = channel;
 535   1        hal_nrf_write_reg (RF_CH, rf_ch.value);
 536   1      }
 537          
 538          void hal_nrf_set_output_power(hal_nrf_output_power_t power)
 539          {
 540   1        rf_setup_t rf_setup;
 541   1        rf_setup.value = hal_nrf_read_reg (RF_SETUP);
 542   1      
 543   1        rf_setup.bits.rf_pwr = (uint8_t)power;
 544   1      
 545   1        hal_nrf_write_reg (RF_SETUP, rf_setup.value);
 546   1      }
 547          
 548          void hal_nrf_set_datarate(hal_nrf_datarate_t datarate)
 549          {
 550   1        rf_setup_t rf_setup;
 551   1        rf_setup.value = hal_nrf_read_reg (RF_SETUP);
 552   1      
 553   1        switch (datarate)
 554   1        {
 555   2          case HAL_NRF_250KBPS:
 556   2            rf_setup.bits.rf_dr_low = 1;
 557   2            rf_setup.bits.rf_dr_high = 0;
 558   2            break;
 559   2          case HAL_NRF_1MBPS:
 560   2            rf_setup.bits.rf_dr_low = 0;
 561   2            rf_setup.bits.rf_dr_high = 0;
 562   2            break;
 563   2          case HAL_NRF_2MBPS:
 564   2          default:
 565   2            rf_setup.bits.rf_dr_low = 0;
 566   2            rf_setup.bits.rf_dr_high = 1;
 567   2            break;
 568   2        }
 569   1      
 570   1        hal_nrf_write_reg (RF_SETUP, rf_setup.value);
 571   1      }
 572          
 573          bool hal_nrf_rx_fifo_empty(void)
 574          {
 575   1        return (bool)((hal_nrf_read_reg(FIFO_STATUS) >> RX_EMPTY) & 1);
 576   1      }
 577          
 578          bool hal_nrf_rx_fifo_full(void)
 579          {
 580   1        return (bool)((hal_nrf_read_reg(FIFO_STATUS)>> RX_FULL) & 1);
 581   1      }
 582          
 583          bool hal_nrf_tx_fifo_empty(void)
 584          {
 585   1        return (bool)((hal_nrf_read_reg(FIFO_STATUS) >> TX_EMPTY) & 1);
 586   1      }
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 34  

 587          
 588          bool hal_nrf_tx_fifo_full(void)
 589          {
 590   1        return (bool)((hal_nrf_read_reg(FIFO_STATUS) >> TX_FIFO_FULL) & 1);
 591   1      }
 592          
 593          uint8_t hal_nrf_get_tx_fifo_status(void)
 594          {
 595   1        return ((hal_nrf_read_reg(FIFO_STATUS) & ((1<<TX_FIFO_FULL)|(1<<TX_EMPTY))) >> 4);
 596   1      }
 597          
 598          uint8_t hal_nrf_get_rx_fifo_status(void)
 599          {
 600   1        return (hal_nrf_read_reg(FIFO_STATUS) & ((1<<RX_FULL)|(1<<RX_EMPTY)));
 601   1      }
 602          
 603          uint8_t hal_nrf_get_fifo_status(void)
 604          {
 605   1        return hal_nrf_read_reg(FIFO_STATUS);
 606   1      }
 607          
 608          uint8_t hal_nrf_get_transmit_attempts(void)
 609          {
 610   1        return (hal_nrf_read_reg(OBSERVE_TX) & (BIT_3|BIT_2|BIT_1|BIT_0));
 611   1      }
 612          
 613          bool hal_nrf_get_carrier_detect(void)
 614          {
 615   1        return hal_nrf_read_reg(CD) & 1;
 616   1      }
 617          
 618          void hal_nrf_activate_features(void)
 619          {return;}
 620          
 621          void hal_nrf_setup_dynamic_payload (uint8_t setup)
 622          {
 623   1        en_pipes_t dynpd;
 624   1        dynpd.value = setup & ~0xC0;
 625   1      
 626   1        hal_nrf_write_reg (DYNPD, dynpd.value);
 627   1      }
 628          
 629          void hal_nrf_enable_dynamic_payload(bool enable)
 630          {
 631   1        feature_t feature;
 632   1        feature.value = hal_nrf_read_reg (FEATURE);
 633   1        feature.bits.en_dpl = (enable) ? 1 : 0;
 634   1      
 635   1        hal_nrf_write_reg (FEATURE, feature.value);
 636   1      }
 637          
 638          void hal_nrf_enable_ack_payload(bool enable)
 639          {
 640   1        feature_t feature;
 641   1        feature.value = hal_nrf_read_reg (FEATURE);
 642   1        feature.bits.en_ack_pay = (enable) ? 1 : 0;
 643   1      
 644   1        hal_nrf_write_reg (FEATURE, feature.value);
 645   1      }
 646          
 647          void hal_nrf_enable_dynamic_ack(bool enable)
 648          {
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 35  

 649   1        feature_t feature;
 650   1        feature.value = hal_nrf_read_reg (FEATURE);
 651   1        feature.bits.en_dyn_ack = (enable) ? 1 : 0;
 652   1      
 653   1        hal_nrf_write_reg (FEATURE, feature.value);
 654   1      }
 655          
 656          void hal_nrf_write_tx_payload(const uint8_t *tx_pload, uint8_t length)
 657          {
 658   1        hal_nrf_write_multibyte_reg(W_TX_PAYLOAD, tx_pload, length);
 659   1      }
 660          
 661          void hal_nrf_write_tx_payload_noack(const uint8_t *tx_pload, uint8_t length)
 662          {
 663   1        hal_nrf_write_multibyte_reg(W_TX_PAYLOAD_NOACK, tx_pload, length);
 664   1      }
 665          
 666          void hal_nrf_write_ack_payload(uint8_t pipe, const uint8_t *tx_pload, uint8_t length)
 667          {
 668   1        hal_nrf_write_multibyte_reg(W_ACK_PAYLOAD | pipe, tx_pload, length);
 669   1      }
 670          
 671          uint8_t hal_nrf_read_rx_payload_width()
 672          {
 673   1        return hal_nrf_read_reg(R_RX_PL_WID);
 674   1      }
 675          
 676          uint16_t hal_nrf_read_rx_payload(uint8_t *rx_pload)
 677          {
 678   1        return hal_nrf_read_multibyte_reg(UINT8(HAL_NRF_RX_PLOAD), rx_pload);
 679   1      }
 680          
 681          uint8_t hal_nrf_get_rx_data_source(void)
 682          {
 683   1        return ((hal_nrf_nop() & (BIT_3|BIT_2|BIT_1)) >> 1);
 684   1      }
 685          
 686          void hal_nrf_reuse_tx(void)
 687          {
 688   1        CSN_LOW();
 689   1        hal_nrf_rw(REUSE_TX_PL);
 690   1        CSN_HIGH();
 691   1      }
 692          
 693          bool hal_nrf_get_reuse_tx_status(void)
 694          {
 695   1        return (bool)((hal_nrf_get_fifo_status() & (1<<TX_REUSE)) >> TX_REUSE);
 696   1      }
 697          
 698          void hal_nrf_flush_rx(void)
 699          {
 700   1        CSN_LOW();
 701   1        hal_nrf_rw(FLUSH_RX);
 702   1        CSN_HIGH();
 703   1      }
 704          
 705          void hal_nrf_flush_tx(void)
 706          {
 707   1        CSN_LOW();
 708   1        hal_nrf_rw(FLUSH_TX);
 709   1        CSN_HIGH();
 710   1      }
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 36  

 711          
 712          uint8_t hal_nrf_nop(void)
 713          {
 714   1        uint8_t retval;
 715   1      
 716   1        CSN_LOW();
 717   1        retval = hal_nrf_rw(NOP);
 718   1        CSN_HIGH();
 719   1      
 720   1        return retval;
 721   1      }
 722          
 723          void hal_nrf_set_pll_mode(bool pll_lock)
 724          {
 725   1        rf_setup_t rf_setup;
 726   1        rf_setup.value = hal_nrf_read_reg (RF_SETUP);
 727   1        rf_setup.bits.pll_lock = (pll_lock) ? 1 : 0;
 728   1      
 729   1        hal_nrf_write_reg(RF_SETUP, rf_setup.value);
 730   1      }
 731          
 732          void hal_nrf_enable_continious_wave (bool enable)
 733          {
 734   1        rf_setup_t rf_setup;
 735   1        rf_setup.value = hal_nrf_read_reg (RF_SETUP);
 736   1        rf_setup.bits.cont_wave = (enable ? 1 : 0);
 737   1      
 738   1        hal_nrf_write_reg(RF_SETUP, rf_setup.value);
 739   1      }
 740          
 741          uint8_t hal_nrf_read_reg(uint8_t reg)
 742          {
 743   1        uint8_t temp;
 744   1      
 745   1        CSN_LOW();
 746   1      
 747   1        HAL_NRF_HW_SPI_WRITE(reg);
 748   1        while(HAL_NRF_HW_SPI_BUSY) {}
 749   1        temp = HAL_NRF_HW_SPI_READ();
 750   1      
 751   1        HAL_NRF_HW_SPI_WRITE(0);
 752   1        while(HAL_NRF_HW_SPI_BUSY) {}
 753   1        temp = HAL_NRF_HW_SPI_READ();
 754   1      
 755   1        CSN_HIGH();
 756   1      
 757   1        return temp;
 758   1      }
 759          
 760          uint8_t hal_nrf_write_reg(uint8_t reg, uint8_t value)
 761          {
 762   1        uint8_t retval;
 763   1      /*lint -esym(550,dummy) symbol not accessed*/
 764   1      /*lint -esym(438,dummy) last assigned value not used*/
 765   1      /*lint -esym(838,dummy) previously assigned value not used*/
 766   1        uint8_t volatile dummy;
 767   1      
 768   1        CSN_LOW();
 769   1      
 770   1        HAL_NRF_HW_SPI_WRITE((W_REGISTER + reg));
 771   1        while(HAL_NRF_HW_SPI_BUSY) {}
 772   1        retval = HAL_NRF_HW_SPI_READ();
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 37  

 773   1      
 774   1        HAL_NRF_HW_SPI_WRITE(value);
 775   1        while(HAL_NRF_HW_SPI_BUSY) {}
 776   1        dummy = HAL_NRF_HW_SPI_READ();
 777   1      
 778   1        CSN_HIGH();
 779   1      
 780   1        return retval;
 781   1      }
 782          
 783          #define NRF_READ_MULTIBYTE_REG_COMMON_BODY \
 784              do \
 785              { \
 786                HAL_NRF_HW_SPI_WRITE(0); \
 787                if (first_round == false) \
 788                { \
 789                  *buf = read_byte; \
 790                  buf++; \
 791                } \
 792                else \
 793                { \
 794                  first_round = false; \
 795                } \
 796                /* wait for byte transfer finished */ \
 797                while(HAL_NRF_HW_SPI_BUSY){} \
 798                read_byte = HAL_NRF_HW_SPI_READ(); \
 799              } while (--ctr); \
 800              *buf = read_byte;
 801          
 802          uint16_t hal_nrf_read_multibyte_reg(uint8_t reg, uint8_t *pbuf)
 803          {
 804   1        uint8_t ctr, length;
 805   1        uint8_t memtype;
 806   1        uint8_t read_byte; /*lint -esym(530,read_byte) symbol not initialized*/
 807   1        bool first_round;
 808   1        first_round = true;
 809   1      
 810   1        memtype = *(uint8_t*)(&pbuf);
 811   1      
 812   1        switch(reg)
 813   1        {
 814   2          case HAL_NRF_PIPE0:
 815   2          case HAL_NRF_PIPE1:
 816   2          case HAL_NRF_TX:
 817   2            length = ctr = hal_nrf_get_address_width();
 818   2            CSN_LOW();
 819   2            hal_nrf_rw(RX_ADDR_P0 + reg);
 820   2            break;
 821   2      
 822   2          case HAL_NRF_RX_PLOAD:
 823   2            if( (reg = hal_nrf_get_rx_data_source()) < 7)
 824   2            {
 825   3              length = ctr = hal_nrf_read_rx_payload_width();
 826   3              CSN_LOW();
 827   3              hal_nrf_rw(R_RX_PAYLOAD);
 828   3            }
 829   2            else
 830   2            {
 831   3              ctr = length = 0;
 832   3            }
 833   2            break;
 834   2      
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 38  

 835   2          default:
 836   2            ctr = length = 0;
 837   2            break;
 838   2        }
 839   1      
 840   1        if (memtype == 0x00)
 841   1        {
 842   2          uint8_t data *buf = (uint8_t data *)pbuf;
 843   2          NRF_READ_MULTIBYTE_REG_COMMON_BODY
 844   2        }
 845   1        else if (memtype == 0x01)
 846   1        {
 847   2          uint8_t xdata *buf = (uint8_t xdata *)pbuf;
 848   2          NRF_READ_MULTIBYTE_REG_COMMON_BODY
 849   2        }
 850   1        else if (memtype == 0xFE)
 851   1        {
 852   2          uint8_t pdata *buf = (uint8_t pdata *)pbuf;
 853   2          NRF_READ_MULTIBYTE_REG_COMMON_BODY
 854   2        }
 855   1        else
 856   1        {
 857   2          uint8_t *buf = (uint8_t *)pbuf;
 858   2          NRF_READ_MULTIBYTE_REG_COMMON_BODY
 859   2        }
 860   1      
 861   1        CSN_HIGH();
 862   1      
 863   1        return (((uint16_t) reg << 8) | length);
 864   1      }
 865          
 866          #define NRF_WRITE_MULTIBYTE_REG_COMMON_BODY \
 867            do \
 868            { \
 869              next = *buf; \
 870              buf++; \
 871              while(HAL_NRF_HW_SPI_BUSY) {}  /* wait for byte transfer finished */ \
 872              dummy = HAL_NRF_HW_SPI_READ(); \
 873              HAL_NRF_HW_SPI_WRITE(next); \
 874            } while (--length);
 875          /*lint -esym(550,dummy) symbol not accessed*/ \
 876          /*lint -esym(438,dummy) last assigned value not used*/ \
 877          /*lint -esym(838,dummy) previously assigned value not used*/ \
 878          void hal_nrf_write_multibyte_reg(uint8_t cmd, const uint8_t *pbuf, uint8_t length)
 879          {
 880   1        uint8_t memtype;
 881   1        uint8_t next;
 882   1        uint8_t volatile dummy;
 883   1      
 884   1        memtype = *(uint8_t*)(&pbuf);
 885   1      
 886   1        CSN_LOW();
 887   1        HAL_NRF_HW_SPI_WRITE(cmd);
 888   1      
 889   1        if (memtype == 0x00)
 890   1        {
 891   2          const uint8_t data *buf = (const uint8_t data *)pbuf;
 892   2          NRF_WRITE_MULTIBYTE_REG_COMMON_BODY
 893   2        }
 894   1        else if (memtype == 0x01)
 895   1        {
 896   2          const uint8_t xdata *buf = (const uint8_t xdata *)pbuf;
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 39  

 897   2          NRF_WRITE_MULTIBYTE_REG_COMMON_BODY
 898   2        }
 899   1        else if (memtype == 0xFE)
 900   1        {
 901   2          const uint8_t pdata *buf = (const uint8_t pdata *)pbuf;
 902   2          NRF_WRITE_MULTIBYTE_REG_COMMON_BODY
 903   2        }
 904   1        else
 905   1        {
 906   2          const uint8_t *buf = (const uint8_t *)pbuf;
 907   2          NRF_WRITE_MULTIBYTE_REG_COMMON_BODY
 908   2        }
 909   1      
 910   1        while(HAL_NRF_HW_SPI_BUSY) {} /* wait for byte transfer finished */
 911   1        dummy = HAL_NRF_HW_SPI_READ();
 912   1        CSN_HIGH();
 913   1      }
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 40  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION _hal_nrf_set_operation_mode (BEGIN)
                                           ; SOURCE LINE # 189
0000 900000      R     MOV     DPTR,#op_mode
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 190
                                           ; SOURCE LINE # 192
0005 E4                CLR     A
0006 FF                MOV     R7,A
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#config
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 194
000F 900000      R     MOV     DPTR,#op_mode
0012 E0                MOVX    A,@DPTR
0013 B40107            CJNE    A,#01H,?C0001
                                           ; SOURCE LINE # 195
                                           ; SOURCE LINE # 196
0016 A3                INC     DPTR
0017 E0                MOVX    A,@DPTR
0018 4401              ORL     A,#01H
001A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 197
001B 8007              SJMP    ?C0002
001D         ?C0001:
                                           ; SOURCE LINE # 199
                                           ; SOURCE LINE # 200
001D 900000      R     MOV     DPTR,#config
0020 E0                MOVX    A,@DPTR
0021 54FE              ANL     A,#0FEH
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 201
0024         ?C0002:
                                           ; SOURCE LINE # 203
0024 900000      R     MOV     DPTR,#config
0027 E0                MOVX    A,@DPTR
0028 FD                MOV     R5,A
0029 E4                CLR     A
002A FF                MOV     R7,A
002B 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_operation_mode (END)

             ; FUNCTION _hal_nrf_set_power_mode (BEGIN)
                                           ; SOURCE LINE # 206
0000 900000      R     MOV     DPTR,#pwr_mode
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 207
                                           ; SOURCE LINE # 209
0005 E4                CLR     A
0006 FF                MOV     R7,A
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#config
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 211
000F 900000      R     MOV     DPTR,#pwr_mode
0012 E0                MOVX    A,@DPTR
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 41  

0013 B40107            CJNE    A,#01H,?C0004
                                           ; SOURCE LINE # 212
                                           ; SOURCE LINE # 213
0016 A3                INC     DPTR
0017 E0                MOVX    A,@DPTR
0018 4402              ORL     A,#02H
001A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 214
001B 8007              SJMP    ?C0005
001D         ?C0004:
                                           ; SOURCE LINE # 216
                                           ; SOURCE LINE # 217
001D 900000      R     MOV     DPTR,#config
0020 E0                MOVX    A,@DPTR
0021 54FD              ANL     A,#0FDH
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 218
0024         ?C0005:
                                           ; SOURCE LINE # 220
0024 900000      R     MOV     DPTR,#config
0027 E0                MOVX    A,@DPTR
0028 FD                MOV     R5,A
0029 E4                CLR     A
002A FF                MOV     R7,A
002B 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_power_mode (END)

             ; FUNCTION _hal_nrf_set_crc_mode (BEGIN)
                                           ; SOURCE LINE # 223
0000 900000      R     MOV     DPTR,#crc_mode
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 224
                                           ; SOURCE LINE # 226
0005 E4                CLR     A
0006 FF                MOV     R7,A
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#config
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 228
000F 900000      R     MOV     DPTR,#crc_mode
0012 E0                MOVX    A,@DPTR
0013 14                DEC     A
0014 6010              JZ      ?C0009
0016 14                DEC     A
0017 601A              JZ      ?C0010
0019 2402              ADD     A,#02H
001B 7021              JNZ     ?C0007
                                           ; SOURCE LINE # 229
                                           ; SOURCE LINE # 230
001D         ?C0008:
                                           ; SOURCE LINE # 231
001D 900000      R     MOV     DPTR,#config
0020 E0                MOVX    A,@DPTR
0021 54F7              ANL     A,#0F7H
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 232
0024 8018              SJMP    ?C0007
                                           ; SOURCE LINE # 233
0026         ?C0009:
                                           ; SOURCE LINE # 234
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 42  

0026 900000      R     MOV     DPTR,#config
0029 E0                MOVX    A,@DPTR
002A 4408              ORL     A,#08H
002C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 235
002D E0                MOVX    A,@DPTR
002E 54FB              ANL     A,#0FBH
0030 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 236
0031 800B              SJMP    ?C0007
                                           ; SOURCE LINE # 237
0033         ?C0010:
                                           ; SOURCE LINE # 238
0033 900000      R     MOV     DPTR,#config
0036 E0                MOVX    A,@DPTR
0037 4408              ORL     A,#08H
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 239
003A E0                MOVX    A,@DPTR
003B 4404              ORL     A,#04H
003D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 240
                                           ; SOURCE LINE # 241
                                           ; SOURCE LINE # 242
                                           ; SOURCE LINE # 243
003E         ?C0007:
                                           ; SOURCE LINE # 245
003E 900000      R     MOV     DPTR,#config
0041 E0                MOVX    A,@DPTR
0042 FD                MOV     R5,A
0043 E4                CLR     A
0044 FF                MOV     R7,A
0045 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_crc_mode (END)

             ; FUNCTION _hal_nrf_set_irq_mode (BEGIN)
                                           ; SOURCE LINE # 248
0000 900000      R     MOV     DPTR,#int_source
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 ED                MOV     A,R5
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 249
                                           ; SOURCE LINE # 251
0008 E4                CLR     A
0009 FF                MOV     R7,A
000A 120000      R     LCALL   _hal_nrf_read_reg
000D 900000      R     MOV     DPTR,#config
0010 EF                MOV     A,R7
0011 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 253
0012 900000      R     MOV     DPTR,#int_source
0015 E0                MOVX    A,@DPTR
0016 24FB              ADD     A,#0FBH
0018 6024              JZ      ?C0017
001A 14                DEC     A
001B 603F              JZ      ?C0020
001D 2402              ADD     A,#02H
001F 7058              JNZ     ?C0013
                                           ; SOURCE LINE # 254
                                           ; SOURCE LINE # 255
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 43  

0021         ?C0014:
                                           ; SOURCE LINE # 256
0021 900000      R     MOV     DPTR,#irq_state
0024 E0                MOVX    A,@DPTR
0025 6004              JZ      ?C0015
0027 7F00              MOV     R7,#00H
0029 8002              SJMP    ?C0016
002B         ?C0015:
002B 7F01              MOV     R7,#01H
002D         ?C0016:
002D EF                MOV     A,R7
002E 5401              ANL     A,#01H
0030 C4                SWAP    A
0031 54F0              ANL     A,#0F0H
0033 FF                MOV     R7,A
0034 900000      R     MOV     DPTR,#config
0037 E0                MOVX    A,@DPTR
0038 54EF              ANL     A,#0EFH
003A 4F                ORL     A,R7
003B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 257
003C 803B              SJMP    ?C0013
                                           ; SOURCE LINE # 258
003E         ?C0017:
                                           ; SOURCE LINE # 259
003E 900000      R     MOV     DPTR,#irq_state
0041 E0                MOVX    A,@DPTR
0042 6004              JZ      ?C0018
0044 7F00              MOV     R7,#00H
0046 8002              SJMP    ?C0019
0048         ?C0018:
0048 7F01              MOV     R7,#01H
004A         ?C0019:
004A EF                MOV     A,R7
004B 5401              ANL     A,#01H
004D C4                SWAP    A
004E 33                RLC     A
004F 54E0              ANL     A,#0E0H
0051 FF                MOV     R7,A
0052 900000      R     MOV     DPTR,#config
0055 E0                MOVX    A,@DPTR
0056 54DF              ANL     A,#0DFH
0058 4F                ORL     A,R7
0059 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 260
005A 801D              SJMP    ?C0013
                                           ; SOURCE LINE # 261
005C         ?C0020:
                                           ; SOURCE LINE # 262
005C 900000      R     MOV     DPTR,#irq_state
005F E0                MOVX    A,@DPTR
0060 6004              JZ      ?C0021
0062 7F00              MOV     R7,#00H
0064 8002              SJMP    ?C0022
0066         ?C0021:
0066 7F01              MOV     R7,#01H
0068         ?C0022:
0068 EF                MOV     A,R7
0069 5401              ANL     A,#01H
006B C4                SWAP    A
006C 33                RLC     A
006D 33                RLC     A
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 44  

006E 54C0              ANL     A,#0C0H
0070 FF                MOV     R7,A
0071 900000      R     MOV     DPTR,#config
0074 E0                MOVX    A,@DPTR
0075 54BF              ANL     A,#0BFH
0077 4F                ORL     A,R7
0078 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 263
                                           ; SOURCE LINE # 264
0079         ?C0013:
                                           ; SOURCE LINE # 266
0079 900000      R     MOV     DPTR,#config
007C E0                MOVX    A,@DPTR
007D FD                MOV     R5,A
007E E4                CLR     A
007F FF                MOV     R7,A
0080 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_irq_mode (END)

             ; FUNCTION hal_nrf_get_clear_irq_flags (BEGIN)
                                           ; SOURCE LINE # 269
                                           ; SOURCE LINE # 270
                                           ; SOURCE LINE # 273
0000 7D70              MOV     R5,#070H
0002 7F07              MOV     R7,#07H
0004 120000      R     LCALL   _hal_nrf_write_reg
;---- Variable 'retval' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 275
0007 EF                MOV     A,R7
0008 5470              ANL     A,#070H
000A FF                MOV     R7,A
                                           ; SOURCE LINE # 276
000B         ?C0024:
000B 22                RET     
             ; FUNCTION hal_nrf_get_clear_irq_flags (END)

             ; FUNCTION hal_nrf_clear_irq_flags_get_status (BEGIN)
                                           ; SOURCE LINE # 278
                                           ; SOURCE LINE # 279
                                           ; SOURCE LINE # 283
0000 7D70              MOV     R5,#070H
0002 7F07              MOV     R7,#07H
0004 120000      R     LCALL   _hal_nrf_write_reg
0007 EF                MOV     A,R7
0008 5470              ANL     A,#070H
000A 900000      R     MOV     DPTR,#retval
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 284
000E E0                MOVX    A,@DPTR
000F FF                MOV     R7,A
0010 C007              PUSH    AR7
0012 7F07              MOV     R7,#07H
0014 120000      R     LCALL   _hal_nrf_read_reg
0017 EF                MOV     A,R7
0018 540F              ANL     A,#0FH
001A FE                MOV     R6,A
001B D0E0              POP     ACC
001D 4E                ORL     A,R6
001E FF                MOV     R7,A
001F 900000      R     MOV     DPTR,#retval
0022 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 286
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 45  

                                           ; SOURCE LINE # 287
0023         ?C0025:
0023 22                RET     
             ; FUNCTION hal_nrf_clear_irq_flags_get_status (END)

             ; FUNCTION _hal_nrf_clear_irq_flag (BEGIN)
                                           ; SOURCE LINE # 290
;---- Variable 'int_source' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 291
                                           ; SOURCE LINE # 292
0000 7401              MOV     A,#01H
0002 A807              MOV     R0,AR7
0004 08                INC     R0
0005 8002              SJMP    ?C0313
0007         ?C0312:
0007 C3                CLR     C
0008 33                RLC     A
0009         ?C0313:
0009 D8FC              DJNZ    R0,?C0312
000B FD                MOV     R5,A
000C 7F07              MOV     R7,#07H
000E 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_clear_irq_flag (END)

             ; FUNCTION hal_nrf_get_irq_flags (BEGIN)
                                           ; SOURCE LINE # 295
                                           ; SOURCE LINE # 296
                                           ; SOURCE LINE # 297
0000 120000      R     LCALL   hal_nrf_nop
0003 EF                MOV     A,R7
0004 5470              ANL     A,#070H
0006 FF                MOV     R7,A
                                           ; SOURCE LINE # 298
0007         ?C0027:
0007 22                RET     
             ; FUNCTION hal_nrf_get_irq_flags (END)

             ; FUNCTION _hal_nrf_open_pipe (BEGIN)
                                           ; SOURCE LINE # 300
0000 900000      R     MOV     DPTR,#pipe_num
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 ED                MOV     A,R5
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 301
                                           ; SOURCE LINE # 304
0008 7F02              MOV     R7,#02H
000A 120000      R     LCALL   _hal_nrf_read_reg
000D 900000      R     MOV     DPTR,#en_rxaddr
0010 EF                MOV     A,R7
0011 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 305
0012 7F01              MOV     R7,#01H
0014 120000      R     LCALL   _hal_nrf_read_reg
0017 900000      R     MOV     DPTR,#en_aa
001A EF                MOV     A,R7
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 307
001C 900000      R     MOV     DPTR,#pipe_num
001F E0                MOVX    A,@DPTR
0020 FF                MOV     R7,A
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 46  

0021 24FA              ADD     A,#0FAH
0023 5006              JNC     ?C0034
0025 2407              ADD     A,#07H
0027 603C              JZ      ?C0037
0029 8053              SJMP    ?C0028
                                           ; SOURCE LINE # 308
                                           ; SOURCE LINE # 309
                                           ; SOURCE LINE # 310
                                           ; SOURCE LINE # 311
                                           ; SOURCE LINE # 312
                                           ; SOURCE LINE # 313
                                           ; SOURCE LINE # 314
002B         ?C0034:
                                           ; SOURCE LINE # 315
002B 7401              MOV     A,#01H
002D A807              MOV     R0,AR7
002F 08                INC     R0
0030 8002              SJMP    ?C0315
0032         ?C0314:
0032 C3                CLR     C
0033 33                RLC     A
0034         ?C0315:
0034 D8FC              DJNZ    R0,?C0314
0036 FD                MOV     R5,A
0037 900000      R     MOV     DPTR,#en_rxaddr
003A E0                MOVX    A,@DPTR
003B 4D                ORL     A,R5
003C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 317
003D 900000      R     MOV     DPTR,#auto_ack
0040 E0                MOVX    A,@DPTR
0041 6008              JZ      ?C0035
                                           ; SOURCE LINE # 318
                                           ; SOURCE LINE # 319
0043 900000      R     MOV     DPTR,#en_aa
0046 E0                MOVX    A,@DPTR
0047 4D                ORL     A,R5
0048 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 320
0049 8033              SJMP    ?C0028
004B         ?C0035:
                                           ; SOURCE LINE # 322
                                           ; SOURCE LINE # 323
004B 900000      R     MOV     DPTR,#pipe_num
004E E0                MOVX    A,@DPTR
004F FF                MOV     R7,A
0050 7401              MOV     A,#01H
0052 A807              MOV     R0,AR7
0054 08                INC     R0
0055 8002              SJMP    ?C0317
0057         ?C0316:
0057 C3                CLR     C
0058 33                RLC     A
0059         ?C0317:
0059 D8FC              DJNZ    R0,?C0316
005B F4                CPL     A
005C FF                MOV     R7,A
005D 900000      R     MOV     DPTR,#en_aa
0060 E0                MOVX    A,@DPTR
0061 5F                ANL     A,R7
0062 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 324
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 47  

                                           ; SOURCE LINE # 325
0063 8019              SJMP    ?C0028
                                           ; SOURCE LINE # 327
0065         ?C0037:
                                           ; SOURCE LINE # 328
0065 900000      R     MOV     DPTR,#en_rxaddr
0068 743F              MOV     A,#03FH
006A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 330
006B 900000      R     MOV     DPTR,#auto_ack
006E E0                MOVX    A,@DPTR
006F 6008              JZ      ?C0038
                                           ; SOURCE LINE # 331
                                           ; SOURCE LINE # 332
0071 900000      R     MOV     DPTR,#en_aa
0074 743F              MOV     A,#03FH
0076 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 333
0077 8005              SJMP    ?C0028
0079         ?C0038:
                                           ; SOURCE LINE # 335
                                           ; SOURCE LINE # 336
0079 E4                CLR     A
007A 900000      R     MOV     DPTR,#en_aa
007D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 337
                                           ; SOURCE LINE # 338
                                           ; SOURCE LINE # 340
                                           ; SOURCE LINE # 341
                                           ; SOURCE LINE # 342
                                           ; SOURCE LINE # 343
007E         ?C0028:
                                           ; SOURCE LINE # 345
007E 900000      R     MOV     DPTR,#en_rxaddr
0081 E0                MOVX    A,@DPTR
0082 FD                MOV     R5,A
0083 7F02              MOV     R7,#02H
0085 120000      R     LCALL   _hal_nrf_write_reg
                                           ; SOURCE LINE # 346
0088 900000      R     MOV     DPTR,#en_aa
008B E0                MOVX    A,@DPTR
008C FD                MOV     R5,A
008D 7F01              MOV     R7,#01H
008F 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_open_pipe (END)

             ; FUNCTION _hal_nrf_close_pipe (BEGIN)
                                           ; SOURCE LINE # 349
0000 900000      R     MOV     DPTR,#pipe_num
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 350
                                           ; SOURCE LINE # 353
0005 7F02              MOV     R7,#02H
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#en_rxaddr
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 354
000F 7F01              MOV     R7,#01H
0011 120000      R     LCALL   _hal_nrf_read_reg
0014 900000      R     MOV     DPTR,#en_aa
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 48  

0017 EF                MOV     A,R7
0018 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 356
0019 900000      R     MOV     DPTR,#pipe_num
001C E0                MOVX    A,@DPTR
001D FF                MOV     R7,A
001E 24FA              ADD     A,#0FAH
0020 5006              JNC     ?C0049
0022 2407              ADD     A,#07H
0024 601B              JZ      ?C0050
0026 8020              SJMP    ?C0043
                                           ; SOURCE LINE # 357
                                           ; SOURCE LINE # 358
                                           ; SOURCE LINE # 359
                                           ; SOURCE LINE # 360
                                           ; SOURCE LINE # 361
                                           ; SOURCE LINE # 362
                                           ; SOURCE LINE # 363
0028         ?C0049:
                                           ; SOURCE LINE # 364
0028 7401              MOV     A,#01H
002A A807              MOV     R0,AR7
002C 08                INC     R0
002D 8002              SJMP    ?C0319
002F         ?C0318:
002F C3                CLR     C
0030 33                RLC     A
0031         ?C0319:
0031 D8FC              DJNZ    R0,?C0318
0033 F4                CPL     A
0034 FD                MOV     R5,A
0035 900000      R     MOV     DPTR,#en_rxaddr
0038 E0                MOVX    A,@DPTR
0039 5D                ANL     A,R5
003A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 365
003B A3                INC     DPTR
003C E0                MOVX    A,@DPTR
003D 5D                ANL     A,R5
003E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 366
003F 8007              SJMP    ?C0043
                                           ; SOURCE LINE # 368
0041         ?C0050:
                                           ; SOURCE LINE # 369
0041 E4                CLR     A
0042 900000      R     MOV     DPTR,#en_rxaddr
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 370
0046 A3                INC     DPTR
0047 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 371
                                           ; SOURCE LINE # 373
                                           ; SOURCE LINE # 374
                                           ; SOURCE LINE # 375
                                           ; SOURCE LINE # 376
0048         ?C0043:
                                           ; SOURCE LINE # 378
0048 900000      R     MOV     DPTR,#en_rxaddr
004B E0                MOVX    A,@DPTR
004C FD                MOV     R5,A
004D 7F02              MOV     R7,#02H
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 49  

004F 120000      R     LCALL   _hal_nrf_write_reg
                                           ; SOURCE LINE # 379
0052 900000      R     MOV     DPTR,#en_aa
0055 E0                MOVX    A,@DPTR
0056 FD                MOV     R5,A
0057 7F01              MOV     R7,#01H
0059 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_close_pipe (END)

             ; FUNCTION _hal_nrf_set_address (BEGIN)
                                           ; SOURCE LINE # 382
0000 900000      R     MOV     DPTR,#addr
0003 EB                MOV     A,R3
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EA                MOV     A,R2
0007 F0                MOVX    @DPTR,A
0008 A3                INC     DPTR
0009 E9                MOV     A,R1
000A F0                MOVX    @DPTR,A
000B 900000      R     MOV     DPTR,#address
000E EF                MOV     A,R7
000F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 383
                                           ; SOURCE LINE # 384
0010 14                DEC     A
0011 600A              JZ      ?C0057
0013 24FB              ADD     A,#0FBH
0015 5021              JNC     ?C0061
0017 6004              JZ      ?C0057
0019 2406              ADD     A,#06H
001B 7032              JNZ     ?C0064
                                           ; SOURCE LINE # 385
                                           ; SOURCE LINE # 386
                                           ; SOURCE LINE # 387
                                           ; SOURCE LINE # 388
001D         ?C0057:
                                           ; SOURCE LINE # 389
001D 120000      R     LCALL   hal_nrf_get_address_width
0020 900000      R     MOV     DPTR,#?_hal_nrf_write_multibyte_reg?BYTE+04H
0023 EF                MOV     A,R7
0024 F0                MOVX    @DPTR,A
0025 900000      R     MOV     DPTR,#address
0028 E0                MOVX    A,@DPTR
0029 242A              ADD     A,#02AH
002B FF                MOV     R7,A
002C A3                INC     DPTR
002D E0                MOVX    A,@DPTR
002E FB                MOV     R3,A
002F A3                INC     DPTR
0030 E0                MOVX    A,@DPTR
0031 FA                MOV     R2,A
0032 A3                INC     DPTR
0033 E0                MOVX    A,@DPTR
0034 F9                MOV     R1,A
0035 020000      R     LJMP    _hal_nrf_write_multibyte_reg
                                           ; SOURCE LINE # 390
                                           ; SOURCE LINE # 391
                                           ; SOURCE LINE # 392
                                           ; SOURCE LINE # 393
                                           ; SOURCE LINE # 394
0038         ?C0061:
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 50  

                                           ; SOURCE LINE # 395
0038 900000      R     MOV     DPTR,#address
003B E0                MOVX    A,@DPTR
003C 240A              ADD     A,#0AH
003E FF                MOV     R7,A
003F A3                INC     DPTR
0040 E0                MOVX    A,@DPTR
0041 FB                MOV     R3,A
0042 A3                INC     DPTR
0043 E0                MOVX    A,@DPTR
0044 FA                MOV     R2,A
0045 A3                INC     DPTR
0046 E0                MOVX    A,@DPTR
0047 F9                MOV     R1,A
0048 120000      E     LCALL   ?C?CLDPTR
004B FD                MOV     R5,A
004C 120000      R     LCALL   _hal_nrf_write_reg
                                           ; SOURCE LINE # 396
                                           ; SOURCE LINE # 398
                                           ; SOURCE LINE # 399
                                           ; SOURCE LINE # 400
                                           ; SOURCE LINE # 401
                                           ; SOURCE LINE # 402
004F         ?C0064:
004F 22                RET     
             ; FUNCTION _hal_nrf_set_address (END)

             ; FUNCTION _hal_nrf_get_address (BEGIN)
                                           ; SOURCE LINE # 404
0000 900000      R     MOV     DPTR,#addr
0003 EB                MOV     A,R3
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EA                MOV     A,R2
0007 F0                MOVX    @DPTR,A
0008 A3                INC     DPTR
0009 E9                MOV     A,R1
000A F0                MOVX    @DPTR,A
000B 900000      R     MOV     DPTR,#address
000E EF                MOV     A,R7
000F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 405
                                           ; SOURCE LINE # 406
0010 14                DEC     A
0011 6008              JZ      ?C0068
0013 24FB              ADD     A,#0FBH
0015 6004              JZ      ?C0068
0017 2406              ADD     A,#06H
0019 7011              JNZ     ?C0070
                                           ; SOURCE LINE # 407
                                           ; SOURCE LINE # 408
                                           ; SOURCE LINE # 409
                                           ; SOURCE LINE # 410
001B         ?C0068:
                                           ; SOURCE LINE # 411
001B 900000      R     MOV     DPTR,#address
001E E0                MOVX    A,@DPTR
001F FF                MOV     R7,A
0020 A3                INC     DPTR
0021 E0                MOVX    A,@DPTR
0022 FB                MOV     R3,A
0023 A3                INC     DPTR
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 51  

0024 E0                MOVX    A,@DPTR
0025 FA                MOV     R2,A
0026 A3                INC     DPTR
0027 E0                MOVX    A,@DPTR
0028 F9                MOV     R1,A
0029 020000      R     LJMP    _hal_nrf_read_multibyte_reg
                                           ; SOURCE LINE # 412
002C         ?C0070:
                                           ; SOURCE LINE # 413
002C 900000      R     MOV     DPTR,#address
002F E0                MOVX    A,@DPTR
0030 240A              ADD     A,#0AH
0032 FF                MOV     R7,A
0033 120000      R     LCALL   _hal_nrf_read_reg
0036 900000      R     MOV     DPTR,#addr
0039 E0                MOVX    A,@DPTR
003A FB                MOV     R3,A
003B A3                INC     DPTR
003C E0                MOVX    A,@DPTR
003D FA                MOV     R2,A
003E A3                INC     DPTR
003F E0                MOVX    A,@DPTR
0040 F9                MOV     R1,A
0041 EF                MOV     A,R7
0042 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 414
0045 7F01              MOV     R7,#01H
                                           ; SOURCE LINE # 415
                                           ; SOURCE LINE # 416
0047         ?C0069:
0047 22                RET     
             ; FUNCTION _hal_nrf_get_address (END)

             ; FUNCTION _hal_nrf_set_auto_retr (BEGIN)
                                           ; SOURCE LINE # 418
;---- Variable 'delay' assigned to Register 'R4/R5' ----
;---- Variable 'retr' assigned to Register 'R3' ----
0000 AB07              MOV     R3,AR7
                                           ; SOURCE LINE # 419
                                           ; SOURCE LINE # 421
0002 EC                MOV     A,R4
0003 540F              ANL     A,#0FH
0005 C4                SWAP    A
0006 54F0              ANL     A,#0F0H
0008 FF                MOV     R7,A
0009 900000      R     MOV     DPTR,#setup_retr
000C E0                MOVX    A,@DPTR
000D 540F              ANL     A,#0FH
000F 4F                ORL     A,R7
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 422
0011 EB                MOV     A,R3
0012 540F              ANL     A,#0FH
0014 FF                MOV     R7,A
0015 E0                MOVX    A,@DPTR
0016 54F0              ANL     A,#0F0H
0018 4F                ORL     A,R7
0019 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 424
001A E0                MOVX    A,@DPTR
001B FD                MOV     R5,A
001C 7F04              MOV     R7,#04H
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 52  

001E 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_auto_retr (END)

             ; FUNCTION _hal_nrf_set_address_width (BEGIN)
                                           ; SOURCE LINE # 427
;---- Variable 'aw' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 428
                                           ; SOURCE LINE # 430
0000 EF                MOV     A,R7
0001 24FE              ADD     A,#0FEH
0003 5403              ANL     A,#03H
0005 FF                MOV     R7,A
0006 900000      R     MOV     DPTR,#setup_aw
0009 E0                MOVX    A,@DPTR
000A 54FC              ANL     A,#0FCH
000C 4F                ORL     A,R7
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 432
000E E0                MOVX    A,@DPTR
000F FD                MOV     R5,A
0010 7F03              MOV     R7,#03H
0012 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_address_width (END)

             ; FUNCTION hal_nrf_get_address_width (BEGIN)
                                           ; SOURCE LINE # 435
                                           ; SOURCE LINE # 436
                                           ; SOURCE LINE # 437
0000 7F03              MOV     R7,#03H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 2402              ADD     A,#02H
0008 FF                MOV     R7,A
                                           ; SOURCE LINE # 438
0009         ?C0073:
0009 22                RET     
             ; FUNCTION hal_nrf_get_address_width (END)

             ; FUNCTION _hal_nrf_set_rx_payload_width (BEGIN)
                                           ; SOURCE LINE # 440
;---- Variable 'pload_width' assigned to Register 'R5' ----
;---- Variable 'pipe_num' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 441
                                           ; SOURCE LINE # 442
0000 EF                MOV     A,R7
0001 2411              ADD     A,#011H
0003 FF                MOV     R7,A
0004 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_rx_payload_width (END)

             ; FUNCTION _hal_nrf_get_pipe_status (BEGIN)
                                           ; SOURCE LINE # 445
0000 900000      R     MOV     DPTR,#pipe_num
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 446
                                           ; SOURCE LINE # 451
0005 7F02              MOV     R7,#02H
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#en_rxaddr
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 53  

                                           ; SOURCE LINE # 452
000F 7F01              MOV     R7,#01H
0011 120000      R     LCALL   _hal_nrf_read_reg
0014 900000      R     MOV     DPTR,#en_aa
0017 EF                MOV     A,R7
0018 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 454
0019 900000      R     MOV     DPTR,#pipe_num
001C E0                MOVX    A,@DPTR
001D 14                DEC     A
001E 6020              JZ      ?C0077
0020 14                DEC     A
0021 6031              JZ      ?C0078
0023 14                DEC     A
0024 6042              JZ      ?C0079
0026 14                DEC     A
0027 6055              JZ      ?C0080
0029 14                DEC     A
002A 6064              JZ      ?C0081
002C 2405              ADD     A,#05H
002E 707A              JNZ     ?C0082
                                           ; SOURCE LINE # 455
                                           ; SOURCE LINE # 456
0030         ?C0076:
                                           ; SOURCE LINE # 457
0030 900000      R     MOV     DPTR,#en_rxaddr
0033 E0                MOVX    A,@DPTR
0034 5401              ANL     A,#01H
0036 900000      R     MOV     DPTR,#en_rx_r
0039 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 458
003A 900000      R     MOV     DPTR,#en_aa
003D E0                MOVX    A,@DPTR
                                           ; SOURCE LINE # 459
003E 8062              SJMP    ?C0326
                                           ; SOURCE LINE # 460
0040         ?C0077:
                                           ; SOURCE LINE # 461
0040 900000      R     MOV     DPTR,#en_rxaddr
0043 E0                MOVX    A,@DPTR
0044 C3                CLR     C
0045 13                RRC     A
0046 5401              ANL     A,#01H
0048 900000      R     MOV     DPTR,#en_rx_r
004B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 462
004C 900000      R     MOV     DPTR,#en_aa
004F E0                MOVX    A,@DPTR
0050 C3                CLR     C
0051 13                RRC     A
0052         ?C0322:
                                           ; SOURCE LINE # 463
0052 804E              SJMP    ?C0326
                                           ; SOURCE LINE # 464
0054         ?C0078:
                                           ; SOURCE LINE # 465
0054 900000      R     MOV     DPTR,#en_rxaddr
0057 E0                MOVX    A,@DPTR
0058 13                RRC     A
0059 13                RRC     A
005A 5401              ANL     A,#01H
005C 900000      R     MOV     DPTR,#en_rx_r
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 54  

005F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 466
0060 900000      R     MOV     DPTR,#en_aa
0063 E0                MOVX    A,@DPTR
0064 13                RRC     A
0065 13                RRC     A
0066         ?C0323:
                                           ; SOURCE LINE # 467
0066 803A              SJMP    ?C0326
                                           ; SOURCE LINE # 468
0068         ?C0079:
                                           ; SOURCE LINE # 469
0068 900000      R     MOV     DPTR,#en_rxaddr
006B E0                MOVX    A,@DPTR
006C 13                RRC     A
006D 13                RRC     A
006E 13                RRC     A
006F 5401              ANL     A,#01H
0071 900000      R     MOV     DPTR,#en_rx_r
0074 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 470
0075 900000      R     MOV     DPTR,#en_aa
0078 E0                MOVX    A,@DPTR
0079 13                RRC     A
007A 13                RRC     A
007B 13                RRC     A
007C         ?C0324:
                                           ; SOURCE LINE # 471
007C 8024              SJMP    ?C0326
                                           ; SOURCE LINE # 472
007E         ?C0080:
                                           ; SOURCE LINE # 473
007E 900000      R     MOV     DPTR,#en_rxaddr
0081 E0                MOVX    A,@DPTR
0082 C4                SWAP    A
0083 5401              ANL     A,#01H
0085 900000      R     MOV     DPTR,#en_rx_r
0088 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 474
0089 900000      R     MOV     DPTR,#en_aa
008C E0                MOVX    A,@DPTR
008D C4                SWAP    A
008E         ?C0325:
                                           ; SOURCE LINE # 475
008E 8012              SJMP    ?C0326
                                           ; SOURCE LINE # 476
0090         ?C0081:
                                           ; SOURCE LINE # 477
0090 900000      R     MOV     DPTR,#en_rxaddr
0093 E0                MOVX    A,@DPTR
0094 C4                SWAP    A
0095 13                RRC     A
0096 5401              ANL     A,#01H
0098 900000      R     MOV     DPTR,#en_rx_r
009B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 478
009C 900000      R     MOV     DPTR,#en_aa
009F E0                MOVX    A,@DPTR
00A0 C4                SWAP    A
00A1 13                RRC     A
00A2         ?C0326:
00A2 5401              ANL     A,#01H
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 55  

00A4 900000      R     MOV     DPTR,#en_aa_r
00A7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 479
00A8 8007              SJMP    ?C0075
                                           ; SOURCE LINE # 480
00AA         ?C0082:
                                           ; SOURCE LINE # 481
00AA E4                CLR     A
00AB 900000      R     MOV     DPTR,#en_rx_r
00AE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 482
00AF A3                INC     DPTR
00B0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 483
                                           ; SOURCE LINE # 484
00B1         ?C0075:
                                           ; SOURCE LINE # 486
00B1 900000      R     MOV     DPTR,#en_aa_r
00B4 E0                MOVX    A,@DPTR
00B5 25E0              ADD     A,ACC
00B7 FF                MOV     R7,A
00B8 900000      R     MOV     DPTR,#en_rx_r
00BB E0                MOVX    A,@DPTR
00BC 2F                ADD     A,R7
00BD FF                MOV     R7,A
                                           ; SOURCE LINE # 487
00BE         ?C0083:
00BE 22                RET     
             ; FUNCTION _hal_nrf_get_pipe_status (END)

             ; FUNCTION hal_nrf_get_auto_retr_status (BEGIN)
                                           ; SOURCE LINE # 489
                                           ; SOURCE LINE # 490
                                           ; SOURCE LINE # 491
0000 7F08              MOV     R7,#08H
0002 120000      R     LCALL   _hal_nrf_read_reg
                                           ; SOURCE LINE # 492
0005         ?C0084:
0005 22                RET     
             ; FUNCTION hal_nrf_get_auto_retr_status (END)

             ; FUNCTION hal_nrf_get_packet_lost_ctr (BEGIN)
                                           ; SOURCE LINE # 494
                                           ; SOURCE LINE # 495
                                           ; SOURCE LINE # 496
0000 7F08              MOV     R7,#08H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 54F0              ANL     A,#0F0H
0008 C4                SWAP    A
0009 540F              ANL     A,#0FH
000B FF                MOV     R7,A
                                           ; SOURCE LINE # 497
000C         ?C0085:
000C 22                RET     
             ; FUNCTION hal_nrf_get_packet_lost_ctr (END)

             ; FUNCTION _hal_nrf_get_rx_payload_width (BEGIN)
                                           ; SOURCE LINE # 499
;---- Variable 'pipe_num' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 500
                                           ; SOURCE LINE # 503
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 56  

0000 EF                MOV     A,R7
0001 14                DEC     A
0002 6014              JZ      ?C0088
0004 14                DEC     A
0005 6015              JZ      ?C0089
0007 14                DEC     A
0008 6016              JZ      ?C0090
000A 14                DEC     A
000B 6017              JZ      ?C0091
000D 14                DEC     A
000E 6018              JZ      ?C0092
0010 2405              ADD     A,#05H
0012 7020              JNZ     ?C0093
                                           ; SOURCE LINE # 504
                                           ; SOURCE LINE # 505
0014         ?C0087:
                                           ; SOURCE LINE # 506
0014 7F11              MOV     R7,#011H
                                           ; SOURCE LINE # 507
0016 8012              SJMP    ?C0331
                                           ; SOURCE LINE # 508
0018         ?C0088:
                                           ; SOURCE LINE # 509
0018 7F12              MOV     R7,#012H
001A         ?C0327:
                                           ; SOURCE LINE # 510
001A 800E              SJMP    ?C0331
                                           ; SOURCE LINE # 511
001C         ?C0089:
                                           ; SOURCE LINE # 512
001C 7F13              MOV     R7,#013H
001E         ?C0328:
                                           ; SOURCE LINE # 513
001E 800A              SJMP    ?C0331
                                           ; SOURCE LINE # 514
0020         ?C0090:
                                           ; SOURCE LINE # 515
0020 7F14              MOV     R7,#014H
0022         ?C0329:
                                           ; SOURCE LINE # 516
0022 8006              SJMP    ?C0331
                                           ; SOURCE LINE # 517
0024         ?C0091:
                                           ; SOURCE LINE # 518
0024 7F15              MOV     R7,#015H
0026         ?C0330:
                                           ; SOURCE LINE # 519
0026 8002              SJMP    ?C0331
                                           ; SOURCE LINE # 520
0028         ?C0092:
                                           ; SOURCE LINE # 521
0028 7F16              MOV     R7,#016H
002A         ?C0331:
002A 120000      R     LCALL   _hal_nrf_read_reg
002D 900000      R     MOV     DPTR,#pw
0030 EF                MOV     A,R7
0031 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 522
0032 8005              SJMP    ?C0086
                                           ; SOURCE LINE # 523
0034         ?C0093:
                                           ; SOURCE LINE # 524
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 57  

0034 E4                CLR     A
0035 900000      R     MOV     DPTR,#pw
0038 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 525
                                           ; SOURCE LINE # 526
0039         ?C0086:
                                           ; SOURCE LINE # 528
0039 900000      R     MOV     DPTR,#pw
003C E0                MOVX    A,@DPTR
003D FF                MOV     R7,A
                                           ; SOURCE LINE # 529
003E         ?C0094:
003E 22                RET     
             ; FUNCTION _hal_nrf_get_rx_payload_width (END)

             ; FUNCTION _hal_nrf_set_rf_channel (BEGIN)
                                           ; SOURCE LINE # 531
;---- Variable 'channel' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 532
                                           ; SOURCE LINE # 534
0000 EF                MOV     A,R7
0001 547F              ANL     A,#07FH
0003 FF                MOV     R7,A
0004 900000      R     MOV     DPTR,#rf_ch
0007 E0                MOVX    A,@DPTR
0008 5480              ANL     A,#080H
000A 4F                ORL     A,R7
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 535
000C E0                MOVX    A,@DPTR
000D FD                MOV     R5,A
000E 7F05              MOV     R7,#05H
0010 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_rf_channel (END)

             ; FUNCTION _hal_nrf_set_output_power (BEGIN)
                                           ; SOURCE LINE # 538
0000 900000      R     MOV     DPTR,#power
                                           ; SOURCE LINE # 539
                                           ; SOURCE LINE # 541
0003 120000      R     LCALL   L?0336
0006 900000      R     MOV     DPTR,#rf_setup
0009 EF                MOV     A,R7
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 543
000B 900000      R     MOV     DPTR,#power
000E E0                MOVX    A,@DPTR
000F 5403              ANL     A,#03H
0011 25E0              ADD     A,ACC
0013 FF                MOV     R7,A
0014 A3                INC     DPTR
0015 E0                MOVX    A,@DPTR
0016 54F9              ANL     A,#0F9H
0018 4F                ORL     A,R7
0019 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 545
001A E0                MOVX    A,@DPTR
001B FD                MOV     R5,A
001C 7F06              MOV     R7,#06H
001E 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_output_power (END)

C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 58  

             ; FUNCTION _hal_nrf_set_datarate (BEGIN)
                                           ; SOURCE LINE # 548
0000 900000      R     MOV     DPTR,#datarate
                                           ; SOURCE LINE # 549
                                           ; SOURCE LINE # 551
0003 120000      R     LCALL   L?0336
0006 900000      R     MOV     DPTR,#rf_setup
0009 EF                MOV     A,R7
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 553
000B 900000      R     MOV     DPTR,#datarate
000E E0                MOVX    A,@DPTR
000F 600C              JZ      ?C0099
0011 24FE              ADD     A,#0FEH
0013 7015              JNZ     ?C0101
                                           ; SOURCE LINE # 554
                                           ; SOURCE LINE # 555
0015         ?C0098:
                                           ; SOURCE LINE # 556
0015 900000      R     MOV     DPTR,#rf_setup
0018 E0                MOVX    A,@DPTR
0019 4420              ORL     A,#020H
                                           ; SOURCE LINE # 557
                                           ; SOURCE LINE # 558
001B 8006              SJMP    ?C0332
                                           ; SOURCE LINE # 559
001D         ?C0099:
                                           ; SOURCE LINE # 560
001D 900000      R     MOV     DPTR,#rf_setup
0020 E0                MOVX    A,@DPTR
0021 54DF              ANL     A,#0DFH
0023         ?C0332:
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 561
0024 E0                MOVX    A,@DPTR
0025 54F7              ANL     A,#0F7H
0027 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 562
0028 800B              SJMP    ?C0097
                                           ; SOURCE LINE # 563
                                           ; SOURCE LINE # 564
002A         ?C0101:
                                           ; SOURCE LINE # 565
002A 900000      R     MOV     DPTR,#rf_setup
002D E0                MOVX    A,@DPTR
002E 54DF              ANL     A,#0DFH
0030 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 566
0031 E0                MOVX    A,@DPTR
0032 4408              ORL     A,#08H
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 567
                                           ; SOURCE LINE # 568
0035         ?C0097:
                                           ; SOURCE LINE # 570
0035 900000      R     MOV     DPTR,#rf_setup
0038 E0                MOVX    A,@DPTR
0039 FD                MOV     R5,A
003A 7F06              MOV     R7,#06H
003C 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_datarate (END)

C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 59  

             ; FUNCTION hal_nrf_rx_fifo_empty (BEGIN)
                                           ; SOURCE LINE # 573
                                           ; SOURCE LINE # 574
                                           ; SOURCE LINE # 575
0000 7F17              MOV     R7,#017H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 5401              ANL     A,#01H
0008 FF                MOV     R7,A
                                           ; SOURCE LINE # 576
0009         ?C0103:
0009 22                RET     
             ; FUNCTION hal_nrf_rx_fifo_empty (END)

             ; FUNCTION hal_nrf_rx_fifo_full (BEGIN)
                                           ; SOURCE LINE # 578
                                           ; SOURCE LINE # 579
                                           ; SOURCE LINE # 580
0000 7F17              MOV     R7,#017H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 C3                CLR     C
0007 13                RRC     A
0008 5401              ANL     A,#01H
000A FF                MOV     R7,A
                                           ; SOURCE LINE # 581
000B         ?C0104:
000B 22                RET     
             ; FUNCTION hal_nrf_rx_fifo_full (END)

             ; FUNCTION hal_nrf_tx_fifo_empty (BEGIN)
                                           ; SOURCE LINE # 583
                                           ; SOURCE LINE # 584
                                           ; SOURCE LINE # 585
0000 7F17              MOV     R7,#017H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 C4                SWAP    A
0007 5401              ANL     A,#01H
0009 FF                MOV     R7,A
                                           ; SOURCE LINE # 586
000A         ?C0105:
000A 22                RET     
             ; FUNCTION hal_nrf_tx_fifo_empty (END)

             ; FUNCTION hal_nrf_tx_fifo_full (BEGIN)
                                           ; SOURCE LINE # 588
                                           ; SOURCE LINE # 589
                                           ; SOURCE LINE # 590
0000 7F17              MOV     R7,#017H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 C4                SWAP    A
0007 13                RRC     A
0008 5401              ANL     A,#01H
000A FF                MOV     R7,A
                                           ; SOURCE LINE # 591
000B         ?C0106:
000B 22                RET     
             ; FUNCTION hal_nrf_tx_fifo_full (END)

             ; FUNCTION hal_nrf_get_tx_fifo_status (BEGIN)
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 60  

                                           ; SOURCE LINE # 593
                                           ; SOURCE LINE # 594
                                           ; SOURCE LINE # 595
0000 7F17              MOV     R7,#017H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 5430              ANL     A,#030H
0008 C4                SWAP    A
0009 540F              ANL     A,#0FH
000B FF                MOV     R7,A
                                           ; SOURCE LINE # 596
000C         ?C0107:
000C 22                RET     
             ; FUNCTION hal_nrf_get_tx_fifo_status (END)

             ; FUNCTION hal_nrf_get_rx_fifo_status (BEGIN)
                                           ; SOURCE LINE # 598
                                           ; SOURCE LINE # 599
                                           ; SOURCE LINE # 600
0000 7F17              MOV     R7,#017H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 5403              ANL     A,#03H
0008 FF                MOV     R7,A
                                           ; SOURCE LINE # 601
0009         ?C0108:
0009 22                RET     
             ; FUNCTION hal_nrf_get_rx_fifo_status (END)

             ; FUNCTION hal_nrf_get_fifo_status (BEGIN)
                                           ; SOURCE LINE # 603
                                           ; SOURCE LINE # 604
                                           ; SOURCE LINE # 605
0000 7F17              MOV     R7,#017H
0002 120000      R     LCALL   _hal_nrf_read_reg
                                           ; SOURCE LINE # 606
0005         ?C0109:
0005 22                RET     
             ; FUNCTION hal_nrf_get_fifo_status (END)

             ; FUNCTION hal_nrf_get_transmit_attempts (BEGIN)
                                           ; SOURCE LINE # 608
                                           ; SOURCE LINE # 609
                                           ; SOURCE LINE # 610
0000 7F08              MOV     R7,#08H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 540F              ANL     A,#0FH
0008 FF                MOV     R7,A
                                           ; SOURCE LINE # 611
0009         ?C0110:
0009 22                RET     
             ; FUNCTION hal_nrf_get_transmit_attempts (END)

             ; FUNCTION hal_nrf_get_carrier_detect (BEGIN)
                                           ; SOURCE LINE # 613
                                           ; SOURCE LINE # 614
                                           ; SOURCE LINE # 615
0000 7F09              MOV     R7,#09H
0002 120000      R     LCALL   _hal_nrf_read_reg
0005 EF                MOV     A,R7
0006 5401              ANL     A,#01H
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 61  

0008 FF                MOV     R7,A
                                           ; SOURCE LINE # 616
0009         ?C0111:
0009 22                RET     
             ; FUNCTION hal_nrf_get_carrier_detect (END)

             ; FUNCTION hal_nrf_activate_features (BEGIN)
                                           ; SOURCE LINE # 618
                                           ; SOURCE LINE # 619
0000         ?C0112:
0000 22                RET     
             ; FUNCTION hal_nrf_activate_features (END)

             ; FUNCTION _hal_nrf_setup_dynamic_payload (BEGIN)
                                           ; SOURCE LINE # 621
;---- Variable 'setup' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 622
                                           ; SOURCE LINE # 624
0000 EF                MOV     A,R7
0001 543F              ANL     A,#03FH
0003 900000      R     MOV     DPTR,#dynpd
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 626
0007 E0                MOVX    A,@DPTR
0008 FD                MOV     R5,A
0009 7F1C              MOV     R7,#01CH
000B 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_setup_dynamic_payload (END)

             ; FUNCTION _hal_nrf_enable_dynamic_payload (BEGIN)
                                           ; SOURCE LINE # 629
0000 900000      R     MOV     DPTR,#enable
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 630
                                           ; SOURCE LINE # 632
0005 7F1D              MOV     R7,#01DH
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#feature
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 633
000F 900000      R     MOV     DPTR,#enable
0012 E0                MOVX    A,@DPTR
0013 6004              JZ      ?C0114
0015 7F01              MOV     R7,#01H
0017 8002              SJMP    ?C0115
0019         ?C0114:
0019 7F00              MOV     R7,#00H
001B         ?C0115:
001B EF                MOV     A,R7
001C 5401              ANL     A,#01H
001E 25E0              ADD     A,ACC
0020 25E0              ADD     A,ACC
0022 FF                MOV     R7,A
0023 900000      R     MOV     DPTR,#feature
0026 E0                MOVX    A,@DPTR
0027 54FB              ANL     A,#0FBH
0029 4F                ORL     A,R7
002A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 635
002B E0                MOVX    A,@DPTR
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 62  

002C FD                MOV     R5,A
002D 7F1D              MOV     R7,#01DH
002F 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_enable_dynamic_payload (END)

             ; FUNCTION _hal_nrf_enable_ack_payload (BEGIN)
                                           ; SOURCE LINE # 638
0000 900000      R     MOV     DPTR,#enable
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 639
                                           ; SOURCE LINE # 641
0005 7F1D              MOV     R7,#01DH
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#feature
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 642
000F 900000      R     MOV     DPTR,#enable
0012 E0                MOVX    A,@DPTR
0013 6004              JZ      ?C0117
0015 7F01              MOV     R7,#01H
0017 8002              SJMP    ?C0118
0019         ?C0117:
0019 7F00              MOV     R7,#00H
001B         ?C0118:
001B EF                MOV     A,R7
001C 5401              ANL     A,#01H
001E 25E0              ADD     A,ACC
0020 FF                MOV     R7,A
0021 900000      R     MOV     DPTR,#feature
0024 E0                MOVX    A,@DPTR
0025 54FD              ANL     A,#0FDH
0027 4F                ORL     A,R7
0028 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 644
0029 E0                MOVX    A,@DPTR
002A FD                MOV     R5,A
002B 7F1D              MOV     R7,#01DH
002D 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_enable_ack_payload (END)

             ; FUNCTION _hal_nrf_enable_dynamic_ack (BEGIN)
                                           ; SOURCE LINE # 647
0000 900000      R     MOV     DPTR,#enable
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 648
                                           ; SOURCE LINE # 650
0005 7F1D              MOV     R7,#01DH
0007 120000      R     LCALL   _hal_nrf_read_reg
000A 900000      R     MOV     DPTR,#feature
000D EF                MOV     A,R7
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 651
000F 900000      R     MOV     DPTR,#enable
0012 E0                MOVX    A,@DPTR
0013 6004              JZ      ?C0120
0015 7F01              MOV     R7,#01H
0017 8002              SJMP    ?C0121
0019         ?C0120:
0019 7F00              MOV     R7,#00H
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 63  

001B         ?C0121:
001B EF                MOV     A,R7
001C 5401              ANL     A,#01H
001E FF                MOV     R7,A
001F 900000      R     MOV     DPTR,#feature
0022 E0                MOVX    A,@DPTR
0023 54FE              ANL     A,#0FEH
0025 4F                ORL     A,R7
0026 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 653
0027 E0                MOVX    A,@DPTR
0028 FD                MOV     R5,A
0029 7F1D              MOV     R7,#01DH
002B 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_enable_dynamic_ack (END)

             ; FUNCTION _hal_nrf_write_tx_payload (BEGIN)
                                           ; SOURCE LINE # 656
;---- Variable 'length' assigned to Register 'R5' ----
;---- Variable 'tx_pload' assigned to Register 'R1/R2/R3' ----
                                           ; SOURCE LINE # 657
                                           ; SOURCE LINE # 658
0000 900000      R     MOV     DPTR,#?_hal_nrf_write_multibyte_reg?BYTE+04H
0003 ED                MOV     A,R5
0004 F0                MOVX    @DPTR,A
0005 7FA0              MOV     R7,#0A0H
0007 020000      R     LJMP    _hal_nrf_write_multibyte_reg
             ; FUNCTION _hal_nrf_write_tx_payload (END)

             ; FUNCTION _hal_nrf_write_tx_payload_noack (BEGIN)
                                           ; SOURCE LINE # 661
;---- Variable 'length' assigned to Register 'R5' ----
;---- Variable 'tx_pload' assigned to Register 'R1/R2/R3' ----
                                           ; SOURCE LINE # 662
                                           ; SOURCE LINE # 663
0000 900000      R     MOV     DPTR,#?_hal_nrf_write_multibyte_reg?BYTE+04H
0003 ED                MOV     A,R5
0004 F0                MOVX    @DPTR,A
0005 7FB0              MOV     R7,#0B0H
0007 020000      R     LJMP    _hal_nrf_write_multibyte_reg
             ; FUNCTION _hal_nrf_write_tx_payload_noack (END)

             ; FUNCTION _hal_nrf_write_ack_payload (BEGIN)
                                           ; SOURCE LINE # 666
;---- Variable 'tx_pload' assigned to Register 'R1/R2/R3' ----
;---- Variable 'pipe' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 667
                                           ; SOURCE LINE # 668
0000 EF                MOV     A,R7
0001 44A8              ORL     A,#0A8H
0003 FF                MOV     R7,A
0004 900000      R     MOV     DPTR,#length
0007 E0                MOVX    A,@DPTR
0008 900000      R     MOV     DPTR,#?_hal_nrf_write_multibyte_reg?BYTE+04H
000B F0                MOVX    @DPTR,A
000C 020000      R     LJMP    _hal_nrf_write_multibyte_reg
             ; FUNCTION _hal_nrf_write_ack_payload (END)

             ; FUNCTION hal_nrf_read_rx_payload_width (BEGIN)
                                           ; SOURCE LINE # 671
                                           ; SOURCE LINE # 672
                                           ; SOURCE LINE # 673
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 64  

0000 7F60              MOV     R7,#060H
0002 120000      R     LCALL   _hal_nrf_read_reg
                                           ; SOURCE LINE # 674
0005         ?C0126:
0005 22                RET     
             ; FUNCTION hal_nrf_read_rx_payload_width (END)

             ; FUNCTION _hal_nrf_read_rx_payload (BEGIN)
                                           ; SOURCE LINE # 676
;---- Variable 'rx_pload' assigned to Register 'R1/R2/R3' ----
                                           ; SOURCE LINE # 677
                                           ; SOURCE LINE # 678
0000 7F08              MOV     R7,#08H
0002 120000      R     LCALL   _hal_nrf_read_multibyte_reg
                                           ; SOURCE LINE # 679
0005         ?C0127:
0005 22                RET     
             ; FUNCTION _hal_nrf_read_rx_payload (END)

             ; FUNCTION hal_nrf_get_rx_data_source (BEGIN)
                                           ; SOURCE LINE # 681
                                           ; SOURCE LINE # 682
                                           ; SOURCE LINE # 683
0000 120000      R     LCALL   hal_nrf_nop
0003 EF                MOV     A,R7
0004 540E              ANL     A,#0EH
0006 C3                CLR     C
0007 13                RRC     A
0008 FF                MOV     R7,A
                                           ; SOURCE LINE # 684
0009         ?C0128:
0009 22                RET     
             ; FUNCTION hal_nrf_get_rx_data_source (END)

             ; FUNCTION hal_nrf_reuse_tx (BEGIN)
                                           ; SOURCE LINE # 686
                                           ; SOURCE LINE # 687
                                           ; SOURCE LINE # 688
0000 C291              CLR     RFCSN
                                           ; SOURCE LINE # 689
0002 7FE3              MOV     R7,#0E3H
0004 120000      E     LCALL   _hal_nrf_rw
                                           ; SOURCE LINE # 690
0007 D291              SETB    RFCSN
                                           ; SOURCE LINE # 691
0009 22                RET     
             ; FUNCTION hal_nrf_reuse_tx (END)

             ; FUNCTION hal_nrf_get_reuse_tx_status (BEGIN)
                                           ; SOURCE LINE # 693
                                           ; SOURCE LINE # 694
                                           ; SOURCE LINE # 695
0000 120000      R     LCALL   hal_nrf_get_fifo_status
0003 EF                MOV     A,R7
0004 5440              ANL     A,#040H
0006 C4                SWAP    A
0007 13                RRC     A
0008 13                RRC     A
0009 5403              ANL     A,#03H
000B FF                MOV     R7,A
                                           ; SOURCE LINE # 696
000C         ?C0136:
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 65  

000C 22                RET     
             ; FUNCTION hal_nrf_get_reuse_tx_status (END)

             ; FUNCTION hal_nrf_flush_rx (BEGIN)
                                           ; SOURCE LINE # 698
                                           ; SOURCE LINE # 699
                                           ; SOURCE LINE # 700
0000 C291              CLR     RFCSN
                                           ; SOURCE LINE # 701
0002 7FE2              MOV     R7,#0E2H
0004 120000      E     LCALL   _hal_nrf_rw
                                           ; SOURCE LINE # 702
0007 D291              SETB    RFCSN
                                           ; SOURCE LINE # 703
0009 22                RET     
             ; FUNCTION hal_nrf_flush_rx (END)

             ; FUNCTION hal_nrf_flush_tx (BEGIN)
                                           ; SOURCE LINE # 705
                                           ; SOURCE LINE # 706
                                           ; SOURCE LINE # 707
0000 C291              CLR     RFCSN
                                           ; SOURCE LINE # 708
0002 7FE1              MOV     R7,#0E1H
0004 120000      E     LCALL   _hal_nrf_rw
                                           ; SOURCE LINE # 709
0007 D291              SETB    RFCSN
                                           ; SOURCE LINE # 710
0009 22                RET     
             ; FUNCTION hal_nrf_flush_tx (END)

             ; FUNCTION hal_nrf_nop (BEGIN)
                                           ; SOURCE LINE # 712
                                           ; SOURCE LINE # 713
                                           ; SOURCE LINE # 716
0000 C291              CLR     RFCSN
                                           ; SOURCE LINE # 717
0002 7FFF              MOV     R7,#0FFH
0004 120000      E     LCALL   _hal_nrf_rw
;---- Variable 'retval' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 718
0007 D291              SETB    RFCSN
                                           ; SOURCE LINE # 720
                                           ; SOURCE LINE # 721
0009         ?C0157:
0009 22                RET     
             ; FUNCTION hal_nrf_nop (END)

             ; FUNCTION _hal_nrf_set_pll_mode (BEGIN)
                                           ; SOURCE LINE # 723
0000 900000      R     MOV     DPTR,#pll_lock
                                           ; SOURCE LINE # 724
                                           ; SOURCE LINE # 726
0003 120000      R     LCALL   L?0337
0006 900000      R     MOV     DPTR,#rf_setup
0009 EF                MOV     A,R7
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 727
000B 900000      R     MOV     DPTR,#pll_lock
000E E0                MOVX    A,@DPTR
000F 6004              JZ      ?C0158
0011 7F01              MOV     R7,#01H
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 66  

0013 8002              SJMP    ?C0159
0015         ?C0158:
0015 7F00              MOV     R7,#00H
0017         ?C0159:
0017 EF                MOV     A,R7
0018 5401              ANL     A,#01H
001A C4                SWAP    A
001B 54F0              ANL     A,#0F0H
001D FF                MOV     R7,A
001E 900000      R     MOV     DPTR,#rf_setup
0021 E0                MOVX    A,@DPTR
0022 54EF              ANL     A,#0EFH
0024 4F                ORL     A,R7
0025 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 729
0026 E0                MOVX    A,@DPTR
0027 FD                MOV     R5,A
0028 7F06              MOV     R7,#06H
002A 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_set_pll_mode (END)

             ; FUNCTION _hal_nrf_enable_continious_wave (BEGIN)
                                           ; SOURCE LINE # 732
0000 900000      R     MOV     DPTR,#enable
                                           ; SOURCE LINE # 733
                                           ; SOURCE LINE # 735
0003 120000      R     LCALL   L?0337
0006 900000      R     MOV     DPTR,#rf_setup
0009 EF                MOV     A,R7
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 736
000B 900000      R     MOV     DPTR,#enable
000E E0                MOVX    A,@DPTR
000F 6004              JZ      ?C0161
0011 7F01              MOV     R7,#01H
0013 8002              SJMP    ?C0162
0015         ?C0161:
0015 7F00              MOV     R7,#00H
0017         ?C0162:
0017 EF                MOV     A,R7
0018 5401              ANL     A,#01H
001A C4                SWAP    A
001B 33                RLC     A
001C 33                RLC     A
001D 33                RLC     A
001E 5480              ANL     A,#080H
0020 FF                MOV     R7,A
0021 900000      R     MOV     DPTR,#rf_setup
0024 E0                MOVX    A,@DPTR
0025 547F              ANL     A,#07FH
0027 4F                ORL     A,R7
0028 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 738
0029 E0                MOVX    A,@DPTR
002A FD                MOV     R5,A
002B 7F06              MOV     R7,#06H
002D 020000      R     LJMP    _hal_nrf_write_reg
             ; FUNCTION _hal_nrf_enable_continious_wave (END)

             ; FUNCTION L?0336 (BEGIN)
0000         L?0337:
0000 EF                MOV     A,R7
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 67  

0001 F0                MOVX    @DPTR,A
0002 7F06              MOV     R7,#06H
             ; FUNCTION _hal_nrf_read_reg (BEGIN)
                                           ; SOURCE LINE # 741
;---- Variable 'reg' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 742
                                           ; SOURCE LINE # 745
0004 C291              CLR     RFCSN
                                           ; SOURCE LINE # 747
0006 8FE5              MOV     RFDAT,R7
0008 C2C0              CLR     RFSPIF
000A         ?C0170:
                                           ; SOURCE LINE # 748
000A 30C0FD            JNB     RFSPIF,?C0170
000D         ?C0171:
                                           ; SOURCE LINE # 749
;---- Variable 'temp' assigned to Register 'R7' ----
000D AFE5              MOV     R7,RFDAT
                                           ; SOURCE LINE # 751
000F E4                CLR     A
0010 F5E5              MOV     RFDAT,A
0012 C2C0              CLR     RFSPIF
0014         ?C0175:
                                           ; SOURCE LINE # 752
0014 30C0FD            JNB     RFSPIF,?C0175
0017         ?C0176:
                                           ; SOURCE LINE # 753
0017 AFE5              MOV     R7,RFDAT
                                           ; SOURCE LINE # 755
0019 D291              SETB    RFCSN
                                           ; SOURCE LINE # 757
                                           ; SOURCE LINE # 758
001B         ?C0180:
001B 22                RET     
             ; FUNCTION _hal_nrf_read_reg (END)

             ; FUNCTION _hal_nrf_write_reg (BEGIN)
                                           ; SOURCE LINE # 760
;---- Variable 'value' assigned to Register 'R5' ----
;---- Variable 'reg' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 761
                                           ; SOURCE LINE # 768
0000 C291              CLR     RFCSN
                                           ; SOURCE LINE # 770
0002 EF                MOV     A,R7
0003 2420              ADD     A,#020H
0005 F5E5              MOV     RFDAT,A
0007 C2C0              CLR     RFSPIF
0009         ?C0187:
                                           ; SOURCE LINE # 771
0009 30C0FD            JNB     RFSPIF,?C0187
000C         ?C0188:
                                           ; SOURCE LINE # 772
;---- Variable 'retval' assigned to Register 'R7' ----
000C AFE5              MOV     R7,RFDAT
                                           ; SOURCE LINE # 774
000E AE05              MOV     R6,AR5
0010 8EE5              MOV     RFDAT,R6
0012 C2C0              CLR     RFSPIF
0014         ?C0192:
                                           ; SOURCE LINE # 775
0014 30C0FD            JNB     RFSPIF,?C0192
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 68  

0017         ?C0193:
                                           ; SOURCE LINE # 776
0017 900000      R     MOV     DPTR,#dummy
001A E5E5              MOV     A,RFDAT
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 778
001D D291              SETB    RFCSN
                                           ; SOURCE LINE # 780
                                           ; SOURCE LINE # 781
001F         ?C0197:
001F 22                RET     
             ; FUNCTION _hal_nrf_write_reg (END)

             ; FUNCTION _hal_nrf_read_multibyte_reg (BEGIN)
                                           ; SOURCE LINE # 802
0000 900000      R     MOV     DPTR,#pbuf
0003 EB                MOV     A,R3
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EA                MOV     A,R2
0007 F0                MOVX    @DPTR,A
0008 A3                INC     DPTR
0009 E9                MOV     A,R1
000A F0                MOVX    @DPTR,A
000B 900000      R     MOV     DPTR,#reg
000E EF                MOV     A,R7
000F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 803
                                           ; SOURCE LINE # 808
0010 900000      R     MOV     DPTR,#first_round
0013 7401              MOV     A,#01H
0015 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 810
0016 900000      R     MOV     DPTR,#pbuf
0019 E0                MOVX    A,@DPTR
001A 900000      R     MOV     DPTR,#memtype
001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 812
001E EF                MOV     A,R7
001F 14                DEC     A
0020 600C              JZ      ?C0201
0022 24FB              ADD     A,#0FBH
0024 6008              JZ      ?C0201
0026 24FE              ADD     A,#0FEH
0028 6019              JZ      ?C0205
002A 2408              ADD     A,#08H
002C 7035              JNZ     ?C0211
                                           ; SOURCE LINE # 813
                                           ; SOURCE LINE # 814
                                           ; SOURCE LINE # 815
                                           ; SOURCE LINE # 816
002E         ?C0201:
                                           ; SOURCE LINE # 817
002E 120000      R     LCALL   hal_nrf_get_address_width
0031 900000      R     MOV     DPTR,#ctr
0034 EF                MOV     A,R7
0035 F0                MOVX    @DPTR,A
0036 A3                INC     DPTR
0037 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 818
0038 C291              CLR     RFCSN
                                           ; SOURCE LINE # 819
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 69  

003A 900000      R     MOV     DPTR,#reg
003D E0                MOVX    A,@DPTR
003E 240A              ADD     A,#0AH
0040 FF                MOV     R7,A
                                           ; SOURCE LINE # 820
0041 801B              SJMP    ?C0333
                                           ; SOURCE LINE # 822
0043         ?C0205:
                                           ; SOURCE LINE # 823
0043 120000      R     LCALL   hal_nrf_get_rx_data_source
0046 900000      R     MOV     DPTR,#reg
0049 EF                MOV     A,R7
004A F0                MOVX    @DPTR,A
004B C3                CLR     C
004C 9407              SUBB    A,#07H
004E 5013              JNC     ?C0334
                                           ; SOURCE LINE # 824
                                           ; SOURCE LINE # 825
0050 120000      R     LCALL   hal_nrf_read_rx_payload_width
0053 900000      R     MOV     DPTR,#ctr
0056 EF                MOV     A,R7
0057 F0                MOVX    @DPTR,A
0058 A3                INC     DPTR
0059 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 826
005A C291              CLR     RFCSN
                                           ; SOURCE LINE # 827
005C 7F61              MOV     R7,#061H
005E         ?C0333:
005E 120000      E     LCALL   _hal_nrf_rw
                                           ; SOURCE LINE # 828
0061 8009              SJMP    ?C0198
                                           ; SOURCE LINE # 835
0063         ?C0211:
                                           ; SOURCE LINE # 836
0063         ?C0334:
0063 E4                CLR     A
0064 900000      R     MOV     DPTR,#length
0067 F0                MOVX    @DPTR,A
0068 900000      R     MOV     DPTR,#ctr
006B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 837
                                           ; SOURCE LINE # 838
006C         ?C0198:
                                           ; SOURCE LINE # 840
006C 900000      R     MOV     DPTR,#memtype
006F E0                MOVX    A,@DPTR
0070 FF                MOV     R7,A
0071 704B              JNZ     ?C0212
                                           ; SOURCE LINE # 841
                                           ; SOURCE LINE # 842
0073 900000      R     MOV     DPTR,#pbuf
0076 A3                INC     DPTR
0077 A3                INC     DPTR
0078 E0                MOVX    A,@DPTR
0079 900000      R     MOV     DPTR,#buf
007C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 843
007D         ?C0218:
007D E4                CLR     A
007E F5E5              MOV     RFDAT,A
0080 C2C0              CLR     RFSPIF
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 70  

0082 900000      R     MOV     DPTR,#first_round
0085 E0                MOVX    A,@DPTR
0086 7011              JNZ     ?C0219
0088 900000      R     MOV     DPTR,#read_byte
008B E0                MOVX    A,@DPTR
008C FE                MOV     R6,A
008D 900000      R     MOV     DPTR,#buf
0090 E0                MOVX    A,@DPTR
0091 F8                MOV     R0,A
0092 A606              MOV     @R0,AR6
0094 E0                MOVX    A,@DPTR
0095 04                INC     A
0096 F0                MOVX    @DPTR,A
0097 8005              SJMP    ?C0221
0099         ?C0219:
0099 E4                CLR     A
009A 900000      R     MOV     DPTR,#first_round
009D F0                MOVX    @DPTR,A
009E         ?C0221:
009E 30C0FD            JNB     RFSPIF,?C0221
00A1         ?C0222:
00A1 900000      R     MOV     DPTR,#read_byte
00A4 E5E5              MOV     A,RFDAT
00A6 F0                MOVX    @DPTR,A
00A7 900000      R     MOV     DPTR,#ctr
00AA E0                MOVX    A,@DPTR
00AB 14                DEC     A
00AC F0                MOVX    @DPTR,A
00AD 70CE              JNZ     ?C0218
00AF 900000      R     MOV     DPTR,#read_byte
00B2 E0                MOVX    A,@DPTR
00B3 FE                MOV     R6,A
00B4 900000      R     MOV     DPTR,#buf
00B7 E0                MOVX    A,@DPTR
00B8 F8                MOV     R0,A
00B9 A606              MOV     @R0,AR6
                                           ; SOURCE LINE # 844
00BB 020000      R     LJMP    ?C0260
00BE         ?C0212:
                                           ; SOURCE LINE # 845
00BE EF                MOV     A,R7
00BF 6401              XRL     A,#01H
00C1 7069              JNZ     ?C0224
                                           ; SOURCE LINE # 846
                                           ; SOURCE LINE # 847
00C3 900000      R     MOV     DPTR,#pbuf
00C6 A3                INC     DPTR
00C7 E0                MOVX    A,@DPTR
00C8 FA                MOV     R2,A
00C9 A3                INC     DPTR
00CA E0                MOVX    A,@DPTR
00CB FF                MOV     R7,A
00CC 900000      R     MOV     DPTR,#buf
00CF EA                MOV     A,R2
00D0 F0                MOVX    @DPTR,A
00D1 A3                INC     DPTR
00D2 EF                MOV     A,R7
00D3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 848
00D4         ?C0230:
00D4 E4                CLR     A
00D5 F5E5              MOV     RFDAT,A
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 71  

00D7 C2C0              CLR     RFSPIF
00D9 900000      R     MOV     DPTR,#first_round
00DC E0                MOVX    A,@DPTR
00DD 7022              JNZ     ?C0231
00DF 900000      R     MOV     DPTR,#read_byte
00E2 E0                MOVX    A,@DPTR
00E3 FF                MOV     R7,A
00E4 900000      R     MOV     DPTR,#buf
00E7 E0                MOVX    A,@DPTR
00E8 FC                MOV     R4,A
00E9 A3                INC     DPTR
00EA E0                MOVX    A,@DPTR
00EB F582              MOV     DPL,A
00ED 8C83              MOV     DPH,R4
00EF EF                MOV     A,R7
00F0 F0                MOVX    @DPTR,A
00F1 900000      R     MOV     DPTR,#buf+01H
00F4 E0                MOVX    A,@DPTR
00F5 04                INC     A
00F6 F0                MOVX    @DPTR,A
00F7 700D              JNZ     ?C0233
00F9 900000      R     MOV     DPTR,#buf
00FC E0                MOVX    A,@DPTR
00FD 04                INC     A
00FE F0                MOVX    @DPTR,A
00FF         ?C0320:
00FF 8005              SJMP    ?C0233
0101         ?C0231:
0101 E4                CLR     A
0102 900000      R     MOV     DPTR,#first_round
0105 F0                MOVX    @DPTR,A
0106         ?C0233:
0106 30C0FD            JNB     RFSPIF,?C0233
0109         ?C0234:
0109 900000      R     MOV     DPTR,#read_byte
010C E5E5              MOV     A,RFDAT
010E F0                MOVX    @DPTR,A
010F 900000      R     MOV     DPTR,#ctr
0112 E0                MOVX    A,@DPTR
0113 14                DEC     A
0114 F0                MOVX    @DPTR,A
0115 70BD              JNZ     ?C0230
0117 900000      R     MOV     DPTR,#read_byte
011A E0                MOVX    A,@DPTR
011B FF                MOV     R7,A
011C 900000      R     MOV     DPTR,#buf
011F E0                MOVX    A,@DPTR
0120 FC                MOV     R4,A
0121 A3                INC     DPTR
0122 E0                MOVX    A,@DPTR
0123 F582              MOV     DPL,A
0125 8C83              MOV     DPH,R4
0127 EF                MOV     A,R7
0128 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 849
0129 020000      R     LJMP    ?C0260
012C         ?C0224:
                                           ; SOURCE LINE # 850
012C 900000      R     MOV     DPTR,#memtype
012F E0                MOVX    A,@DPTR
0130 64FE              XRL     A,#0FEH
0132 704A              JNZ     ?C0236
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 72  

                                           ; SOURCE LINE # 851
                                           ; SOURCE LINE # 852
0134 900000      R     MOV     DPTR,#pbuf
0137 A3                INC     DPTR
0138 A3                INC     DPTR
0139 E0                MOVX    A,@DPTR
013A 900000      R     MOV     DPTR,#buf
013D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 853
013E         ?C0242:
013E E4                CLR     A
013F F5E5              MOV     RFDAT,A
0141 C2C0              CLR     RFSPIF
0143 900000      R     MOV     DPTR,#first_round
0146 E0                MOVX    A,@DPTR
0147 7011              JNZ     ?C0243
0149 900000      R     MOV     DPTR,#read_byte
014C E0                MOVX    A,@DPTR
014D FF                MOV     R7,A
014E 900000      R     MOV     DPTR,#buf
0151 E0                MOVX    A,@DPTR
0152 F8                MOV     R0,A
0153 EF                MOV     A,R7
0154 F2                MOVX    @R0,A
0155 E0                MOVX    A,@DPTR
0156 04                INC     A
0157 F0                MOVX    @DPTR,A
0158 8005              SJMP    ?C0245
015A         ?C0243:
015A E4                CLR     A
015B 900000      R     MOV     DPTR,#first_round
015E F0                MOVX    @DPTR,A
015F         ?C0245:
015F 30C0FD            JNB     RFSPIF,?C0245
0162         ?C0246:
0162 900000      R     MOV     DPTR,#read_byte
0165 E5E5              MOV     A,RFDAT
0167 F0                MOVX    @DPTR,A
0168 900000      R     MOV     DPTR,#ctr
016B E0                MOVX    A,@DPTR
016C 14                DEC     A
016D F0                MOVX    @DPTR,A
016E 70CE              JNZ     ?C0242
0170 900000      R     MOV     DPTR,#read_byte
0173 E0                MOVX    A,@DPTR
0174 FF                MOV     R7,A
0175 900000      R     MOV     DPTR,#buf
0178 E0                MOVX    A,@DPTR
0179 F8                MOV     R0,A
017A EF                MOV     A,R7
017B F2                MOVX    @R0,A
                                           ; SOURCE LINE # 854
017C 806A              SJMP    ?C0260
017E         ?C0236:
                                           ; SOURCE LINE # 856
                                           ; SOURCE LINE # 857
017E 900000      R     MOV     DPTR,#pbuf
0181 E0                MOVX    A,@DPTR
0182 F9                MOV     R1,A
0183 A3                INC     DPTR
0184 E0                MOVX    A,@DPTR
0185 FA                MOV     R2,A
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 73  

0186 A3                INC     DPTR
0187 E0                MOVX    A,@DPTR
0188 900000      R     MOV     DPTR,#buf
018B C9                XCH     A,R1
018C F0                MOVX    @DPTR,A
018D A3                INC     DPTR
018E EA                MOV     A,R2
018F F0                MOVX    @DPTR,A
0190 A3                INC     DPTR
0191 E9                MOV     A,R1
0192 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 858
0193         ?C0253:
0193 E4                CLR     A
0194 F5E5              MOV     RFDAT,A
0196 C2C0              CLR     RFSPIF
0198 900000      R     MOV     DPTR,#first_round
019B E0                MOVX    A,@DPTR
019C 7020              JNZ     ?C0254
019E 900000      R     MOV     DPTR,#read_byte
01A1 E0                MOVX    A,@DPTR
01A2 FF                MOV     R7,A
01A3 900000      R     MOV     DPTR,#buf
01A6 E0                MOVX    A,@DPTR
01A7 FB                MOV     R3,A
01A8 A3                INC     DPTR
01A9 E0                MOVX    A,@DPTR
01AA FA                MOV     R2,A
01AB A3                INC     DPTR
01AC E0                MOVX    A,@DPTR
01AD F9                MOV     R1,A
01AE EF                MOV     A,R7
01AF 120000      E     LCALL   ?C?CSTPTR
01B2 900000      R     MOV     DPTR,#buf+01H
01B5 E4                CLR     A
01B6 75F001            MOV     B,#01H
01B9 120000      E     LCALL   ?C?IILDX
01BC 8005              SJMP    ?C0256
01BE         ?C0254:
01BE E4                CLR     A
01BF 900000      R     MOV     DPTR,#first_round
01C2 F0                MOVX    @DPTR,A
01C3         ?C0256:
01C3 30C0FD            JNB     RFSPIF,?C0256
01C6         ?C0257:
01C6 900000      R     MOV     DPTR,#read_byte
01C9 E5E5              MOV     A,RFDAT
01CB F0                MOVX    @DPTR,A
01CC 900000      R     MOV     DPTR,#ctr
01CF E0                MOVX    A,@DPTR
01D0 14                DEC     A
01D1 F0                MOVX    @DPTR,A
01D2 70BF              JNZ     ?C0253
01D4 900000      R     MOV     DPTR,#read_byte
01D7 E0                MOVX    A,@DPTR
01D8 FF                MOV     R7,A
01D9 900000      R     MOV     DPTR,#buf
01DC E0                MOVX    A,@DPTR
01DD FB                MOV     R3,A
01DE A3                INC     DPTR
01DF E0                MOVX    A,@DPTR
01E0 FA                MOV     R2,A
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 74  

01E1 A3                INC     DPTR
01E2 E0                MOVX    A,@DPTR
01E3 F9                MOV     R1,A
01E4 EF                MOV     A,R7
01E5 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 859
01E8         ?C0260:
                                           ; SOURCE LINE # 861
01E8 D291              SETB    RFCSN
                                           ; SOURCE LINE # 863
01EA 900000      R     MOV     DPTR,#reg
01ED E0                MOVX    A,@DPTR
01EE FE                MOV     R6,A
01EF 900000      R     MOV     DPTR,#length
01F2 E0                MOVX    A,@DPTR
01F3 FD                MOV     R5,A
01F4 ED                MOV     A,R5
01F5 FF                MOV     R7,A
                                           ; SOURCE LINE # 864
01F6         ?C0261:
01F6 22                RET     
             ; FUNCTION _hal_nrf_read_multibyte_reg (END)

             ; FUNCTION _hal_nrf_write_multibyte_reg (BEGIN)
                                           ; SOURCE LINE # 875
;---- Variable 'next' assigned to Register 'R6' ----
0000 900000      R     MOV     DPTR,#pbuf
0003 EB                MOV     A,R3
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EA                MOV     A,R2
0007 F0                MOVX    @DPTR,A
0008 A3                INC     DPTR
0009 E9                MOV     A,R1
000A F0                MOVX    @DPTR,A
;---- Variable 'cmd' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 879
                                           ; SOURCE LINE # 884
000B 900000      R     MOV     DPTR,#pbuf
000E E0                MOVX    A,@DPTR
000F FD                MOV     R5,A
;---- Variable 'memtype' assigned to Register 'R5' ----
                                           ; SOURCE LINE # 886
0010 C291              CLR     RFCSN
                                           ; SOURCE LINE # 887
0012 8FE5              MOV     RFDAT,R7
0014 C2C0              CLR     RFSPIF
                                           ; SOURCE LINE # 889
0016 ED                MOV     A,R5
0017 7029              JNZ     ?C0268
                                           ; SOURCE LINE # 890
                                           ; SOURCE LINE # 891
0019 A3                INC     DPTR
001A A3                INC     DPTR
001B E0                MOVX    A,@DPTR
001C 900000      R     MOV     DPTR,#buf
001F F0                MOVX    @DPTR,A
0020         ?C0271:
                                           ; SOURCE LINE # 892
0020 900000      R     MOV     DPTR,#buf
0023 E0                MOVX    A,@DPTR
0024 F8                MOV     R0,A
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 75  

0025 E6                MOV     A,@R0
0026 FE                MOV     R6,A
0027 E0                MOVX    A,@DPTR
0028 04                INC     A
0029 F0                MOVX    @DPTR,A
002A         ?C0272:
002A 30C0FD            JNB     RFSPIF,?C0272
002D         ?C0273:
002D 900000      R     MOV     DPTR,#dummy
0030 E5E5              MOV     A,RFDAT
0032 F0                MOVX    @DPTR,A
0033 8EE5              MOV     RFDAT,R6
0035 C2C0              CLR     RFSPIF
0037 900000      R     MOV     DPTR,#length
003A E0                MOVX    A,@DPTR
003B 14                DEC     A
003C F0                MOVX    @DPTR,A
003D 70E1              JNZ     ?C0271
                                           ; SOURCE LINE # 893
003F 020000      R     LJMP    ?C0306
0042         ?C0268:
                                           ; SOURCE LINE # 894
0042 ED                MOV     A,R5
0043 6401              XRL     A,#01H
0045 7042              JNZ     ?C0278
                                           ; SOURCE LINE # 895
                                           ; SOURCE LINE # 896
0047 900000      R     MOV     DPTR,#pbuf
004A A3                INC     DPTR
004B E0                MOVX    A,@DPTR
004C FB                MOV     R3,A
004D A3                INC     DPTR
004E E0                MOVX    A,@DPTR
004F 900000      R     MOV     DPTR,#buf
0052 CB                XCH     A,R3
0053 F0                MOVX    @DPTR,A
0054 A3                INC     DPTR
0055 EB                MOV     A,R3
0056 F0                MOVX    @DPTR,A
0057         ?C0281:
                                           ; SOURCE LINE # 897
0057 900000      R     MOV     DPTR,#buf
005A E0                MOVX    A,@DPTR
005B FE                MOV     R6,A
005C A3                INC     DPTR
005D E0                MOVX    A,@DPTR
005E F582              MOV     DPL,A
0060 8E83              MOV     DPH,R6
0062 E0                MOVX    A,@DPTR
0063 FE                MOV     R6,A
0064 900000      R     MOV     DPTR,#buf+01H
0067 E0                MOVX    A,@DPTR
0068 04                INC     A
0069 F0                MOVX    @DPTR,A
006A 7006              JNZ     ?C0321
006C 900000      R     MOV     DPTR,#buf
006F E0                MOVX    A,@DPTR
0070 04                INC     A
0071 F0                MOVX    @DPTR,A
0072         ?C0321:
0072         ?C0282:
0072 30C0FD            JNB     RFSPIF,?C0282
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 76  

0075         ?C0283:
0075 900000      R     MOV     DPTR,#dummy
0078 E5E5              MOV     A,RFDAT
007A F0                MOVX    @DPTR,A
007B 8EE5              MOV     RFDAT,R6
007D C2C0              CLR     RFSPIF
007F 900000      R     MOV     DPTR,#length
0082 E0                MOVX    A,@DPTR
0083 14                DEC     A
0084 F0                MOVX    @DPTR,A
0085 70D0              JNZ     ?C0281
                                           ; SOURCE LINE # 898
0087         ?C0335:
0087 8073              SJMP    ?C0306
0089         ?C0278:
                                           ; SOURCE LINE # 899
0089 ED                MOV     A,R5
008A 64FE              XRL     A,#0FEH
008C 702B              JNZ     ?C0288
                                           ; SOURCE LINE # 900
                                           ; SOURCE LINE # 901
008E 900000      R     MOV     DPTR,#pbuf
0091 A3                INC     DPTR
0092 A3                INC     DPTR
0093 E0                MOVX    A,@DPTR
0094 900000      R     MOV     DPTR,#buf
0097 F0                MOVX    @DPTR,A
0098         ?C0291:
                                           ; SOURCE LINE # 902
0098 900000      R     MOV     DPTR,#buf
009B E0                MOVX    A,@DPTR
009C F8                MOV     R0,A
009D E2                MOVX    A,@R0
009E FE                MOV     R6,A
009F E0                MOVX    A,@DPTR
00A0 04                INC     A
00A1 F0                MOVX    @DPTR,A
00A2         ?C0292:
00A2 30C0FD            JNB     RFSPIF,?C0292
00A5         ?C0293:
00A5 900000      R     MOV     DPTR,#dummy
00A8 E5E5              MOV     A,RFDAT
00AA F0                MOVX    @DPTR,A
00AB 8EE5              MOV     RFDAT,R6
00AD C2C0              CLR     RFSPIF
00AF 900000      R     MOV     DPTR,#length
00B2 E0                MOVX    A,@DPTR
00B3 14                DEC     A
00B4 F0                MOVX    @DPTR,A
00B5 70E1              JNZ     ?C0291
                                           ; SOURCE LINE # 903
00B7 8043              SJMP    ?C0306
00B9         ?C0288:
                                           ; SOURCE LINE # 905
                                           ; SOURCE LINE # 906
00B9 900000      R     MOV     DPTR,#pbuf
00BC E0                MOVX    A,@DPTR
00BD F9                MOV     R1,A
00BE A3                INC     DPTR
00BF E0                MOVX    A,@DPTR
00C0 FA                MOV     R2,A
00C1 A3                INC     DPTR
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 77  

00C2 E0                MOVX    A,@DPTR
00C3 900000      R     MOV     DPTR,#buf
00C6 C9                XCH     A,R1
00C7 F0                MOVX    @DPTR,A
00C8 A3                INC     DPTR
00C9 EA                MOV     A,R2
00CA F0                MOVX    @DPTR,A
00CB A3                INC     DPTR
00CC E9                MOV     A,R1
00CD F0                MOVX    @DPTR,A
00CE         ?C0300:
                                           ; SOURCE LINE # 907
00CE 900000      R     MOV     DPTR,#buf
00D1 E0                MOVX    A,@DPTR
00D2 FB                MOV     R3,A
00D3 A3                INC     DPTR
00D4 E0                MOVX    A,@DPTR
00D5 FA                MOV     R2,A
00D6 A3                INC     DPTR
00D7 E0                MOVX    A,@DPTR
00D8 F9                MOV     R1,A
00D9 120000      E     LCALL   ?C?CLDPTR
00DC FE                MOV     R6,A
00DD 900000      R     MOV     DPTR,#buf+01H
00E0 E4                CLR     A
00E1 75F001            MOV     B,#01H
00E4 120000      E     LCALL   ?C?IILDX
00E7         ?C0301:
00E7 30C0FD            JNB     RFSPIF,?C0301
00EA         ?C0302:
00EA 900000      R     MOV     DPTR,#dummy
00ED E5E5              MOV     A,RFDAT
00EF F0                MOVX    @DPTR,A
00F0 8EE5              MOV     RFDAT,R6
00F2 C2C0              CLR     RFSPIF
00F4 900000      R     MOV     DPTR,#length
00F7 E0                MOVX    A,@DPTR
00F8 14                DEC     A
00F9 F0                MOVX    @DPTR,A
00FA 70D2              JNZ     ?C0300
                                           ; SOURCE LINE # 908
00FC         ?C0306:
                                           ; SOURCE LINE # 910
00FC 30C0FD            JNB     RFSPIF,?C0306
00FF         ?C0307:
                                           ; SOURCE LINE # 911
00FF 900000      R     MOV     DPTR,#dummy
0102 E5E5              MOV     A,RFDAT
0104 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 912
0105 D291              SETB    RFCSN
                                           ; SOURCE LINE # 913
0107 22                RET     
             ; FUNCTION _hal_nrf_write_multibyte_reg (END)

C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 78  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


hal_nrf_address_t. . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
HAL_NRF_CRC_16BIT. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
uint16_t . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
P0 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0080H  1
HAL_NRF_0DBM . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_address_width_t. . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
_hal_nrf_set_rf_channel. . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  channel. . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  rf_ch. . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0000H  1
_hal_nrf_open_pipe . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  pipe_num . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  auto_ack . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0001H  1
  en_rxaddr. . . . . . . . . . . . . .  AUTO     XDATA  UNION    0002H  1
  en_aa. . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0003H  1
_hal_nrf_enable_dynamic_ack. . . . . .  PUBLIC   CODE   PROC     0000H  -----
  enable . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  feature. . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
int32_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  LONG     -----  4
rx_pw_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
HAL_NRF_6DBM . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
int16_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  INT      -----  2
_hal_nrf_write_tx_payload. . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  tx_pload . . . . . . . . . . . . . .  * REG *  DATA   PTR      0001H  3
  length . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0005H  1
hal_nrf_get_clear_irq_flags. . . . . .  PUBLIC   CODE   PROC     0000H  -----
  retval . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
_hal_nrf_enable_ack_payload. . . . . .  PUBLIC   CODE   PROC     0000H  -----
  enable . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  feature. . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
IEN0 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A8H  1
_hal_nrf_write_reg . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  reg. . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  value. . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0005H  1
  retval . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  dummy. . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
hal_nrf_nop. . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  retval . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
_hal_nrf_setup_dynamic_payload . . . .  PUBLIC   CODE   PROC     0000H  -----
  setup. . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  dynpd. . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0000H  1
IEN1 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B8H  1
hal_nrf_get_fifo_status. . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
HAL_NRF_PWR_DOWN . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_CRC_OFF. . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_clear_irq_flags_get_status . .  PUBLIC   CODE   PROC     0000H  -----
  retval . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
_hal_nrf_get_pipe_status . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  pipe_num . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  en_rxaddr. . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
  en_aa. . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0002H  1
  en_rx_r. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0003H  1
  en_aa_r. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0004H  1
HAL_NRF_RX_DR. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_hal_nrf_get_rx_payload_width. . . . .  PUBLIC   CODE   PROC     0000H  -----
  pipe_num . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 79  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


  pw . . . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
hal_nrf_get_irq_flags. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
HAL_NRF_ACK_PLOAD. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_TX_DS. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_hal_nrf_set_power_mode. . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  pwr_mode . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  config . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
setup_retr_t . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
_hal_nrf_rw. . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
HAL_NRF_TX . . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_get_carrier_detect . . . . . .  PUBLIC   CODE   PROC     0000H  -----
_hal_nrf_set_rx_payload_width. . . . .  PUBLIC   CODE   PROC     0000H  -----
  pipe_num . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  pload_width. . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0005H  1
en_pipes_t . . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
hal_nrf_get_packet_lost_ctr. . . . . .  PUBLIC   CODE   PROC     0000H  -----
_hal_nrf_set_crc_mode. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  crc_mode . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  config . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
hal_nrf_flush_rx . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
hal_nrf_flush_tx . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
hal_nrf_get_transmit_attempts. . . . .  PUBLIC   CODE   PROC     0000H  -----
HAL_NRF_AW_3BYTES. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_reuse_tx . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
_hal_nrf_set_output_power. . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  power. . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  rf_setup . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
HAL_NRF_AW_4BYTES. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
TCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0088H  1
HAL_NRF_AW_5BYTES. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_12DBM. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_hal_nrf_set_datarate. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  datarate . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  rf_setup . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
HAL_NRF_18DBM. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_hal_nrf_set_pll_mode. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  pll_lock . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  rf_setup . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
hal_nrf_get_rx_data_source . . . . . .  PUBLIC   CODE   PROC     0000H  -----
rf_setup_t . . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
setup_aw_t . . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
_hal_nrf_set_irq_mode. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  int_source . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  irq_state. . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0001H  1
  config . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0002H  1
_hal_nrf_read_multibyte_reg. . . . . .  PUBLIC   CODE   PROC     0000H  -----
  reg. . . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  pbuf . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0001H  3
  buf. . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0009H  1
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 80  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


  buf. . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0009H  2
  buf. . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0009H  1
  buf. . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0009H  3
  ctr. . . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0004H  1
  length . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0005H  1
  memtype. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0006H  1
  read_byte. . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0007H  1
  first_round. . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0008H  1
hal_nrf_rx_fifo_empty. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
_hal_nrf_enable_dynamic_payload. . . .  PUBLIC   CODE   PROC     0000H  -----
  enable . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  feature. . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
feature_t. . . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
hal_nrf_tx_fifo_empty. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
hal_nrf_get_auto_retr_status . . . . .  PUBLIC   CODE   PROC     0000H  -----
hal_nrf_rx_fifo_full . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
HAL_NRF_250KBPS. . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_tx_fifo_full . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
_hal_nrf_set_auto_retr . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  retr . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0003H  1
  delay. . . . . . . . . . . . . . . .  * REG *  DATA   U_INT    0004H  2
  setup_retr . . . . . . . . . . . . .  AUTO     XDATA  UNION    0000H  1
_hal_nrf_get_address . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  address. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  addr . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0001H  3
RFSPIF . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00C0H  1
USBCON . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A0H  1
_hal_nrf_set_operation_mode. . . . . .  PUBLIC   CODE   PROC     0000H  -----
  op_mode. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  config . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
config_t . . . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
_hal_nrf_write_ack_payload . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  pipe . . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0007H  1
  tx_pload . . . . . . . . . . . . . .  AUTO     DATA   PTR      0001H  3
  length . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0004H  1
HAL_NRF_CRC_8BIT . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
uint8_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
hal_nrf_get_address_width. . . . . . .  PUBLIC   CODE   PROC     0000H  -----
_hal_nrf_write_multibyte_reg . . . . .  PUBLIC   CODE   PROC     0000H  -----
  cmd. . . . . . . . . . . . . . . . .  AUTO     DATA   U_CHAR   0007H  1
  pbuf . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0001H  3
  length . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0004H  1
  buf. . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0006H  1
  buf. . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0006H  2
  buf. . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0006H  1
  buf. . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0006H  3
  memtype. . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0005H  1
  next . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0006H  1
  dummy. . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0005H  1
hal_nrf_crc_mode_t . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
HAL_NRF_ALL. . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_irq_source_t . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
_hal_nrf_set_address . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 81  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


  address. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  addr . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0001H  3
rf_ch_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  1
  value. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  bits . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  1
int8_t . . . . . . . . . . . . . . . .  TYPEDEF  -----  CHAR     -----  1
hal_nrf_output_power_t . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
hal_nrf_activate_features. . . . . . .  PUBLIC   CODE   PROC     0000H  -----
hal_nrf_get_rx_fifo_status . . . . . .  PUBLIC   CODE   PROC     0000H  -----
_hal_nrf_set_address_width . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  aw . . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  setup_aw . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0000H  1
HAL_NRF_PIPE0. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_get_tx_fifo_status . . . . . .  PUBLIC   CODE   PROC     0000H  -----
HAL_NRF_PIPE1. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_get_reuse_tx_status. . . . . .  PUBLIC   CODE   PROC     0000H  -----
HAL_NRF_PIPE2. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_datarate_t . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
HAL_NRF_PIPE3. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_PIPE4. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_PIPE5. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_1MBPS. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_2MBPS. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
S0CON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0098H  1
T2CON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C8H  1
_hal_nrf_close_pipe. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  pipe_num . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  en_rxaddr. . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
  en_aa. . . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0002H  1
FSR. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F8H  1
hal_nrf_pload_command_t. . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
HAL_NRF_MAX_RT . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_Bool. . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
AESCS. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E8H  1
RFDAT. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E5H  1
_hal_nrf_enable_continious_wave. . . .  PUBLIC   CODE   PROC     0000H  -----
  enable . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  rf_setup . . . . . . . . . . . . . .  AUTO     XDATA  UNION    0001H  1
hal_nrf_operation_mode_t . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
_hal_nrf_clear_irq_flag. . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  int_source . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
hal_nrf_pwr_mode_t . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
_hal_nrf_read_rx_payload . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  rx_pload . . . . . . . . . . . . . .  * REG *  DATA   PTR      0001H  3
HAL_NRF_PRX. . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
RFCON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0090H  1
_hal_nrf_write_tx_payload_noack. . . .  PUBLIC   CODE   PROC     0000H  -----
  tx_pload . . . . . . . . . . . . . .  * REG *  DATA   PTR      0001H  3
  length . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0005H  1
PSW. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D0H  1
HAL_NRF_RX_PLOAD . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
HAL_NRF_PTX. . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
hal_nrf_read_rx_payload_width. . . . .  PUBLIC   CODE   PROC     0000H  -----
WDCON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D8H  1
IRCON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C0H  1
HAL_NRF_TX_PLOAD . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
uint32_t . . . . . . . . . . . . . . .  TYPEDEF  -----  U_LONG   -----  4
C51 COMPILER V9.03   HAL_NRF                                                               06/20/2011 20:16:57 PAGE 82  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


_hal_nrf_read_reg. . . . . . . . . . .  PUBLIC   CODE   PROC     0004H  -----
  reg. . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  temp . . . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
RFCSN. . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0091H  1
HAL_NRF_PWR_UP . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2500    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----      76
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
